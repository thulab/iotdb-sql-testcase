
-- [1]9:create database root.sg
STRICT{
PASS
}

-- [1]10:create timeseries root.sg.d1.s1 with datatype=float,encoding=RLE
STRICT{
PASS
}

-- [1]11:create timeseries root.sg.d1.s2 with datatype=double,encoding=RLE
STRICT{
PASS
}

-- [1]12:create timeseries root.sg.d1.s3 with datatype=int32,encoding=RLE
STRICT{
PASS
}

-- [1]13:create timeseries root.sg.d1.s4 with datatype=int64,encoding=RLE
STRICT{
PASS
}

-- [1]14:create timeseries root.sg.d1.s5 with datatype=BOOLEAN,encoding=RLE
STRICT{
PASS
}

-- [1]15:create timeseries root.sg.d1.s6 with datatype=TEXT,encoding=PLAIN
STRICT{
PASS
}

-- [1]18:show databases root.sg
STRICT{
Database(TEXT)      |SchemaReplicationFactor(INT32)      |DataReplicationFactor(INT32)      |TimePartitionOrigin(INT64)      |TimePartitionInterval(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg             |1                                   |1                                 |0                               |604800000                         |
总数目：1
}
Elapsed Time: 0.0.2

-- [1]19:show devices root.sg.*
STRICT{
Device(TEXT)      |IsAligned(TEXT)      |Template(TEXT)      |TTL(ms)(TEXT)      |
------------------------------------------------------------------------------
root.sg.d1        |false                |null                |INF                |
总数目：1
}
Elapsed Time: 0.0.3

-- [1]20:show timeseries root.sg.**
STRICT{
Timeseries(TEXT)      |Alias(TEXT)      |Database(TEXT)      |DataType(TEXT)      |Encoding(TEXT)      |Compression(TEXT)      |Tags(TEXT)      |Attributes(TEXT)      |Deadband(TEXT)      |DeadbandParameters(TEXT)      |ViewType(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s3         |null             |root.sg             |INT32               |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s4         |null             |root.sg             |INT64               |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s5         |null             |root.sg             |BOOLEAN             |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s6         |null             |root.sg             |TEXT                |PLAIN               |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s1         |null             |root.sg             |FLOAT               |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s2         |null             |root.sg             |DOUBLE              |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
总数目：6
}
Elapsed Time: 0.0.2

-- [1]23:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(1,10000.00,80.00,60,1001,false,'assedfkedcc')
STRICT{
0
}
Elapsed Time: 0.0.52

-- [1]24:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(2,9999.01,60.00,89,2500,false,'test001')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]25:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(3,20021.11,50.90,99,500,true,'hunl10test')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]26:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(4,3500.01,100.00,100,20,false,'test001')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]27:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(5,1522.25,66.96,60,1001,false,'adddcc')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]28:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(6,9999.99,90.00,89,-1,true,'test002')
STRICT{
0
}
Elapsed Time: 0.0.0

-- [1]29:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(7,20000.00,100.00,92,888,false,'V1')
STRICT{
0
}
Elapsed Time: 0.0.0

-- [1]30:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(8,49001.01,85.00,72,20,false,'test001')
STRICT{
0
}
Elapsed Time: 0.0.0

-- [1]31:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(9,5890.02,99.12,85,-101,true,'V2')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]32:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(10,11000.11,87.1,0,111,false,'V1')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]35:select s1, s2 from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s1(FLOAT)      |root.sg.d1.s2(DOUBLE)      |
--------------------------------------------------------------------------
1                    |10000.0                   |80.0                       |
--------------------------------------------------------------------------
2                    |9999.01                   |60.0                       |
--------------------------------------------------------------------------
3                    |20021.11                  |50.9                       |
--------------------------------------------------------------------------
4                    |3500.01                   |100.0                      |
--------------------------------------------------------------------------
5                    |1522.25                   |66.96                      |
--------------------------------------------------------------------------
6                    |9999.99                   |90.0                       |
--------------------------------------------------------------------------
7                    |20000.0                   |100.0                      |
--------------------------------------------------------------------------
8                    |49001.01                  |85.0                       |
--------------------------------------------------------------------------
9                    |5890.02                   |99.12                      |
--------------------------------------------------------------------------
10                   |11000.11                  |87.1                       |
总数目：10
}
Elapsed Time: 0.0.3

-- [1]36:select s1, s2, case when s1 >= 10000 and s1 < 50000 and s2 >= 90 and s2 <= 200 then "perfect~~~" when s1 >= 5000 and s1 < 10000 or s2 >80 and s2 < 90 then "very well~~~" when s1 < 5000 or s2<= 80 then "just so so~~~" end as `Evaluation Results` from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s1(FLOAT)      |root.sg.d1.s2(DOUBLE)      |Evaluation Results(TEXT)      |
--------------------------------------------------------------------------------------------------------
1                    |10000.0                   |80.0                       |just so so~~~                 |
--------------------------------------------------------------------------------------------------------
2                    |9999.01                   |60.0                       |very well~~~                  |
--------------------------------------------------------------------------------------------------------
3                    |20021.11                  |50.9                       |just so so~~~                 |
--------------------------------------------------------------------------------------------------------
4                    |3500.01                   |100.0                      |just so so~~~                 |
--------------------------------------------------------------------------------------------------------
5                    |1522.25                   |66.96                      |just so so~~~                 |
--------------------------------------------------------------------------------------------------------
6                    |9999.99                   |90.0                       |very well~~~                  |
--------------------------------------------------------------------------------------------------------
7                    |20000.0                   |100.0                      |perfect~~~                    |
--------------------------------------------------------------------------------------------------------
8                    |49001.01                  |85.0                       |very well~~~                  |
--------------------------------------------------------------------------------------------------------
9                    |5890.02                   |99.12                      |very well~~~                  |
--------------------------------------------------------------------------------------------------------
10                   |11000.11                  |87.1                       |very well~~~                  |
总数目：10
}
Elapsed Time: 0.0.14

-- [1]39:select s6, case when s6 like "%cc%" then "has cc" when s6 like "%test%" then "has test" when s6 like "%1" then "has 1" else "no any more" end as `Evaluation Results` from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s6(TEXT)      |Evaluation Results(TEXT)      |
----------------------------------------------------------------------------
1                    |assedfkedcc              |has cc                        |
----------------------------------------------------------------------------
2                    |test001                  |has test                      |
----------------------------------------------------------------------------
3                    |hunl10test               |has test                      |
----------------------------------------------------------------------------
4                    |test001                  |has test                      |
----------------------------------------------------------------------------
5                    |adddcc                   |has cc                        |
----------------------------------------------------------------------------
6                    |test002                  |has test                      |
----------------------------------------------------------------------------
7                    |V1                       |has 1                         |
----------------------------------------------------------------------------
8                    |test001                  |has test                      |
----------------------------------------------------------------------------
9                    |V2                       |no any more                   |
----------------------------------------------------------------------------
10                   |V1                       |has 1                         |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]43:select s3 from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(INT32)      |
-----------------------------------------------
1                    |60                        |
-----------------------------------------------
2                    |89                        |
-----------------------------------------------
3                    |99                        |
-----------------------------------------------
4                    |100                       |
-----------------------------------------------
5                    |60                        |
-----------------------------------------------
6                    |89                        |
-----------------------------------------------
7                    |92                        |
-----------------------------------------------
8                    |72                        |
-----------------------------------------------
9                    |85                        |
-----------------------------------------------
10                   |0                         |
总数目：10
}
Elapsed Time: 0.0.3

-- [1]45:select count(case when s3 <= 70 then 1 end) as `(-∞, 70]`, count(case when s3 > 70 and s3 <= 80 then 1 end) as `(70,80]`, count(case when s3 > 80 and s3 <= 90 then 1 end) as `(80,90]`, count (case when s3 > 90 then 1 end) as `(90,+∞]` from root.sg.d1
STRICT{
(-∞, 70](INT64)      |(70,80](INT64)      |(80,90](INT64)      |(90,+∞](INT64)      |
---------------------------------------------------------------------------------
3                    |1                   |3                   |3                   |
总数目：1
}
Elapsed Time: 0.0.8

-- [1]47:select sum(case when s3 <= 70 then 1 end) as `(-∞, 70]`, sum(case when s3 > 70 and s3 <= 80 then 1 end) as `(70,80]`, sum(case when s3 > 80 and s3 <= 90 then 1 end) as `(80,90]`, sum (case when s3 > 90 then 1 end) as `(90,+∞]` from root.sg.d1
STRICT{
(-∞, 70](DOUBLE)      |(70,80](DOUBLE)      |(80,90](DOUBLE)      |(90,+∞](DOUBLE)      |
-------------------------------------------------------------------------------------
3.0                   |1.0                  |3.0                  |3.0                  |
总数目：1
}
Elapsed Time: 0.0.4

-- [1]48:select s4 from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s4(INT64)      |
-----------------------------------------------
1                    |1001                      |
-----------------------------------------------
2                    |2500                      |
-----------------------------------------------
3                    |500                       |
-----------------------------------------------
4                    |20                        |
-----------------------------------------------
5                    |1001                      |
-----------------------------------------------
6                    |-1                        |
-----------------------------------------------
7                    |888                       |
-----------------------------------------------
8                    |20                        |
-----------------------------------------------
9                    |-101                      |
-----------------------------------------------
10                   |111                       |
总数目：10
}
Elapsed Time: 0.0.2

-- [1]49:select MAX_VALUE(case when s4 <= 20 then 0 end) as `(-∞, 20]`, MAX_VALUE(case when s4 > 20 and s4 <= 500 then 0 end) as `(20,500]`, MAX_VALUE(case when s4 > 500 and s4 <= 1000 then 0 end) as `(500,1000]`, MAX_VALUE(case when s4 > 1000 then 0 end) as `(1000,+∞]` from root.sg.d1
STRICT{
(-∞, 20](DOUBLE)      |(20,500](DOUBLE)      |(500,1000](DOUBLE)      |(1000,+∞](DOUBLE)      |
-------------------------------------------------------------------------------------------
0.0                   |0.0                   |0.0                     |0.0                    |
总数目：1
}
Elapsed Time: 0.0.4

-- [1]50:select MAX_VALUE(case when s4 <= 20 then -1 end) as `(-∞, 20]`, MAX_VALUE(case when s4 > 20 and s4 <= 500 then -1 end) as `(20,500]`, MAX_VALUE(case when s4 > 500 and s4 <= 1000 then -1 end) as `(500,1000]`, MAX_VALUE(case when s4 > 1000 then -1 end) as `(1000,+∞]` from root.sg.d1
STRICT{
(-∞, 20](DOUBLE)      |(20,500](DOUBLE)      |(500,1000](DOUBLE)      |(1000,+∞](DOUBLE)      |
-------------------------------------------------------------------------------------------
-1.0                  |-1.0                  |-1.0                    |-1.0                   |
总数目：1
}
Elapsed Time: 0.0.7

-- [1]51:select MAX_TIME(case when s4 <= 20 then "yes" end) as `(-∞, 20]`, MAX_TIME(case when s4 > 20 and s4 <= 500 then "yes" end) as `(20,500]`, MAX_TIME(case when s4 > 500 and s4 <= 1000 then "yes" end) as `(500,1000]`, MAX_TIME(case when s4 > 1000 then "yes" end) as `(1000,+∞]` from root.sg.d1
STRICT{
(-∞, 20](INT64)      |(20,500](INT64)      |(500,1000](INT64)      |(1000,+∞](INT64)      |
---------------------------------------------------------------------------------------
9                    |10                   |7                      |5                     |
总数目：1
}
Elapsed Time: 0.0.4

-- [1]52:select LAST_VALUE(case when s4 <= 20 then "low" end) as `result 1`, LAST_VALUE(case when s4 > 20 and s4 <= 500 then "medium" end) as `result 2`,LAST_VALUE(case when s4 > 500 and s4 <= 1000 then "high" end) as `result 3` from root.sg.d1
STRICT{
result 1(TEXT)      |result 2(TEXT)      |result 3(TEXT)      |
------------------------------------------------------------
low                 |medium              |high                |
总数目：1
}
Elapsed Time: 0.0.3

-- [1]54:select case when s3 > 85 then avg(s3) else last_value(s3) end from root.sg.d1
STRICT{
SQLSTATE : 701: Raw data and aggregation result hybrid calculation is not supported.
}

-- [1]58:select s1, case s1 when 20000 then "Gold Medal" when 10000 then "Silver Medal" else "missed it" end from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s1(FLOAT)      |CASE WHEN root.sg.d1.s1 = 20000 THEN "Gold Medal" WHEN root.sg.d1.s1 = 10000 THEN "Silver Medal" ELSE "missed it" END(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                    |10000.0                   |Silver Medal                                                                                                                     |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2                    |9999.01                   |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3                    |20021.11                  |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |3500.01                   |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5                    |1522.25                   |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6                    |9999.99                   |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
7                    |20000.0                   |Gold Medal                                                                                                                       |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |49001.01                  |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
9                    |5890.02                   |missed it                                                                                                                        |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
10                   |11000.11                  |missed it                                                                                                                        |
总数目：10
}
Elapsed Time: 0.0.3

-- [1]59:select s2, case s2 when 100 then "A" when 90 then "B" when 85 then "C" else "Others" end from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s2(DOUBLE)      |CASE WHEN root.sg.d1.s2 = 100 THEN "A" WHEN root.sg.d1.s2 = 90 THEN "B" WHEN root.sg.d1.s2 = 85 THEN "C" ELSE "Others" END(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                    |80.0                       |Others                                                                                                                                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2                    |60.0                       |Others                                                                                                                                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3                    |50.9                       |Others                                                                                                                                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |100.0                      |A                                                                                                                                     |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5                    |66.96                      |Others                                                                                                                                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6                    |90.0                       |B                                                                                                                                     |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
7                    |100.0                      |A                                                                                                                                     |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |85.0                       |C                                                                                                                                     |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
9                    |99.12                      |Others                                                                                                                                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
10                   |87.1                       |Others                                                                                                                                |
总数目：10
}
Elapsed Time: 0.0.3

-- [1]63:select s3, case s3 when 100 then true when 0 then 2 end from root.sg.d1
STRICT{
SQLSTATE : 701: CASE expression: BOOLEAN and other types cannot exist at the same time
}

-- [1]66:select s3, case s3 when 100 then true when 0 then false end as `result` from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(INT32)      |result(BOOLEAN)      |
--------------------------------------------------------------------
1                    |60                        |null                 |
--------------------------------------------------------------------
2                    |89                        |null                 |
--------------------------------------------------------------------
3                    |99                        |null                 |
--------------------------------------------------------------------
4                    |100                       |true                 |
--------------------------------------------------------------------
5                    |60                        |null                 |
--------------------------------------------------------------------
6                    |89                        |null                 |
--------------------------------------------------------------------
7                    |92                        |null                 |
--------------------------------------------------------------------
8                    |72                        |null                 |
--------------------------------------------------------------------
9                    |85                        |null                 |
--------------------------------------------------------------------
10                   |0                         |false                |
总数目：10
}
Elapsed Time: 0.0.4

-- [1]68:select s2, case s2 when 100 then 100 when 50 then "out" end from root.sg.d1
STRICT{
SQLSTATE : 701: CASE expression: TEXT and other types cannot exist at the same time
}

-- [1]71:select s2, case s2 when 100 then "pass" when 50 then "out" end as `result` from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s2(DOUBLE)      |result(TEXT)      |
------------------------------------------------------------------
1                    |80.0                       |null              |
------------------------------------------------------------------
2                    |60.0                       |null              |
------------------------------------------------------------------
3                    |50.9                       |null              |
------------------------------------------------------------------
4                    |100.0                      |pass              |
------------------------------------------------------------------
5                    |66.96                      |null              |
------------------------------------------------------------------
6                    |90.0                       |null              |
------------------------------------------------------------------
7                    |100.0                      |pass              |
------------------------------------------------------------------
8                    |85.0                       |null              |
------------------------------------------------------------------
9                    |99.12                      |null              |
------------------------------------------------------------------
10                   |87.1                       |null              |
总数目：10
}
Elapsed Time: 0.0.3

-- [1]73:select s4, case s4 when 500 then 500 when 111 then 111.01 when 20 then 2000000000000000000 when -101 then -101.1111111111111111111111111111111111111111111 end as `result` from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s4(INT64)      |result(DOUBLE)      |
-------------------------------------------------------------------
1                    |1001                      |null                |
-------------------------------------------------------------------
2                    |2500                      |null                |
-------------------------------------------------------------------
3                    |500                       |500.0               |
-------------------------------------------------------------------
4                    |20                        |2.0E18              |
-------------------------------------------------------------------
5                    |1001                      |null                |
-------------------------------------------------------------------
6                    |-1                        |null                |
-------------------------------------------------------------------
7                    |888                       |null                |
-------------------------------------------------------------------
8                    |20                        |2.0E18              |
-------------------------------------------------------------------
9                    |-101                      |-101.11111111111111 |
-------------------------------------------------------------------
10                   |111                       |111.01              |
总数目：10
}
Elapsed Time: 0.0.4

-- [1]78:select 	202 + ((time - 1) + (202-79.1) / 5.039) as no_bug, 	case when true then 202 + ((time - 1) + (202-79.1) / 5.039) end as bug_again, 	s4  from root.sg.d1
STRICT{
Time(TIMESTAMP)      |no_bug(DOUBLE)      |bug_again(DOUBLE)      |root.sg.d1.s4(INT64)      |
------------------------------------------------------------------------------------------
1                    |226.38975987299068  |226.38975987299068     |1001                      |
------------------------------------------------------------------------------------------
2                    |227.38975987299068  |227.38975987299068     |2500                      |
------------------------------------------------------------------------------------------
3                    |228.38975987299068  |228.38975987299068     |500                       |
------------------------------------------------------------------------------------------
4                    |229.38975987299068  |229.38975987299068     |20                        |
------------------------------------------------------------------------------------------
5                    |230.38975987299068  |230.38975987299068     |1001                      |
------------------------------------------------------------------------------------------
6                    |231.38975987299068  |231.38975987299068     |-1                        |
------------------------------------------------------------------------------------------
7                    |232.38975987299068  |232.38975987299068     |888                       |
------------------------------------------------------------------------------------------
8                    |233.38975987299068  |233.38975987299068     |20                        |
------------------------------------------------------------------------------------------
9                    |234.38975987299068  |234.38975987299068     |-101                      |
------------------------------------------------------------------------------------------
10                   |235.38975987299068  |235.38975987299068     |111                       |
总数目：10
}
Elapsed Time: 0.0.7
