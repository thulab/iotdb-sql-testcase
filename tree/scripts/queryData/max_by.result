-- [1]16:create database root.sg
STRICT{
PASS
}
-- [1]17:create timeseries root.sg.d1.s1 with datatype=DOUBLE
STRICT{
PASS
}
-- [1]18:create timeseries root.sg.d1.s2 with datatype=INT32
STRICT{
PASS
}
-- [1]19:create timeseries root.sg.d1.s3 with datatype=FLOAT
STRICT{
PASS
}
-- [1]20:create timeseries root.sg.d1.s4 with datatype=INT64
STRICT{
PASS
}
-- [1]21:create timeseries root.sg.d1.s5 with datatype=BOOLEAN
STRICT{
PASS
}
-- [1]22:create timeseries root.sg.d1.s6 with datatype=TEXT
STRICT{
PASS
}
-- [1]23:create aligned timeseries root.sg.d2(s1 DOUBLE, s2 INT32, s3 FLOAT, s4 INT64, s5 BOOLEAN, s6 TEXT)
STRICT{
PASS
}

-- [1]26:show databases root.sg
STRICT{
Database(TEXT)      |SchemaReplicationFactor(INT32)      |DataReplicationFactor(INT32)      |TimePartitionOrigin(INT64)      |TimePartitionInterval(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg             |1                                   |1                                 |0                               |604800000                         |
总数目：1
}

Elapsed Time: 0.0.40

-- [1]27:show devices root.sg.**
STRICT{
Device(TEXT)      |IsAligned(TEXT)      |Template(TEXT)      |TTL(ms)(TEXT)      |
------------------------------------------------------------------------------
root.sg.d1        |false                |null                |INF                |
------------------------------------------------------------------------------
root.sg.d2        |true                 |null                |INF                |
总数目：2
}

Elapsed Time: 0.0.69

-- [1]28:show timeseries root.sg.**
STRICT{
Timeseries(TEXT)      |Alias(TEXT)      |Database(TEXT)      |DataType(TEXT)      |Encoding(TEXT)      |Compression(TEXT)      |Tags(TEXT)      |Attributes(TEXT)      |Deadband(TEXT)      |DeadbandParameters(TEXT)      |ViewType(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s3         |null             |root.sg             |FLOAT               |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s4         |null             |root.sg             |INT64               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s5         |null             |root.sg             |BOOLEAN             |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s6         |null             |root.sg             |TEXT                |PLAIN               |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s1         |null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s2         |null             |root.sg             |INT32               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s3         |null             |root.sg             |FLOAT               |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s4         |null             |root.sg             |INT64               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s5         |null             |root.sg             |BOOLEAN             |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s6         |null             |root.sg             |TEXT                |PLAIN               |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s1         |null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s2         |null             |root.sg             |INT32               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
总数目：12
}

Elapsed Time: 0.0.11
-- [1]31:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(1,100.1,1,10.1,12,false,'test01')
STRICT{
0
}

Elapsed Time: 0.0.216
-- [1]32:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(2,60.2,36,150.5,155,true,'test02')
STRICT{
0
}

Elapsed Time: 0.0.8
-- [1]33:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(3,255.6,2,10.1,12,false,'test03')
STRICT{
0
}

Elapsed Time: 0.0.3
-- [1]34:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(4,0.2,333,222.2,1010,true,'test04')
STRICT{
0
}

Elapsed Time: 0.0.3
-- [1]35:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(5,1.1,0,4.14,188,false,'test05')
STRICT{
0
}

Elapsed Time: 0.0.2
-- [1]36:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(6,255.6,333,80.6,2500,true,'test06')
STRICT{
0
}

Elapsed Time: 0.0.1
-- [1]37:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(7,16.6,333,null,3610,false,'test07')
STRICT{
0
}

Elapsed Time: 0.0.2
-- [1]38:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(1,1.1,999,111.1,16,true,'A01Db')
STRICT{
0
}

Elapsed Time: 0.0.96
-- [1]39:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(2,155.5,101,-1.1,66,false,'BNno10112Dnc')
STRICT{
0
}

Elapsed Time: 0.0.4
-- [1]40:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(3,0.12,11,55.5,360,true,'LpNY10sdhj')
STRICT{
0
}

Elapsed Time: 0.0.2

-- [1]46:select * from root.sg.** align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s3(FLOAT)      |s4(INT64)      |s5(BOOLEAN)      |s6(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d1        |10.1           |12             |false            |test01        |100.1           |1              |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d1        |150.5          |155            |true             |test02        |60.2            |36             |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d1        |10.1           |12             |false            |test03        |255.6           |2              |
-----------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |222.2          |1010           |true             |test04        |0.2             |333            |
-----------------------------------------------------------------------------------------------------------------------------------
5                    |root.sg.d1        |4.14           |188            |false            |test05        |1.1             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
6                    |root.sg.d1        |80.6           |2500           |true             |test06        |255.6           |333            |
-----------------------------------------------------------------------------------------------------------------------------------
7                    |root.sg.d1        |null           |3610           |false            |test07        |16.6            |333            |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d2        |111.1          |16             |true             |A01Db         |1.1             |999            |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d2        |-1.1           |66             |false            |BNno10112Dnc  |155.5           |101            |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d2        |55.5           |360            |true             |LpNY10sdhj    |0.12            |11             |
总数目：10
}

Elapsed Time: 0.0.102

-- [1]49:select s1 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s1(DOUBLE)      |root.sg.d2.s1(DOUBLE)      |
---------------------------------------------------------------------------
1                    |100.1                      |1.1                        |
---------------------------------------------------------------------------
2                    |60.2                       |155.5                      |
---------------------------------------------------------------------------
3                    |255.6                      |0.12                       |
---------------------------------------------------------------------------
4                    |0.2                        |null                       |
---------------------------------------------------------------------------
5                    |1.1                        |null                       |
---------------------------------------------------------------------------
6                    |255.6                      |null                       |
---------------------------------------------------------------------------
7                    |16.6                       |null                       |
总数目：7
}

Elapsed Time: 0.0.19

-- [1]50:select max_by(time,s1) from root.sg.**
STRICT{
max_by(Time, root.sg.d1.s1)(INT64)      |max_by(Time, root.sg.d2.s1)(INT64)      |
--------------------------------------------------------------------------------
3                                       |2                                       |
总数目：1
}

Elapsed Time: 0.0.27

-- [1]51:select s2 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s2(INT32)      |root.sg.d2.s2(INT32)      |
-------------------------------------------------------------------------
1                    |1                         |999                       |
-------------------------------------------------------------------------
2                    |36                        |101                       |
-------------------------------------------------------------------------
3                    |2                         |11                        |
-------------------------------------------------------------------------
4                    |333                       |null                      |
-------------------------------------------------------------------------
5                    |0                         |null                      |
-------------------------------------------------------------------------
6                    |333                       |null                      |
-------------------------------------------------------------------------
7                    |333                       |null                      |
总数目：7
}

Elapsed Time: 0.0.11

-- [1]52:select max_by(time,s2) from root.sg.**
STRICT{
max_by(Time, root.sg.d1.s2)(INT64)      |max_by(Time, root.sg.d2.s2)(INT64)      |
--------------------------------------------------------------------------------
4                                       |1                                       |
总数目：1
}

Elapsed Time: 0.0.10

-- [1]53:select s3 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(FLOAT)      |root.sg.d2.s3(FLOAT)      |
-------------------------------------------------------------------------
1                    |10.1                      |111.1                     |
-------------------------------------------------------------------------
2                    |150.5                     |-1.1                      |
-------------------------------------------------------------------------
3                    |10.1                      |55.5                      |
-------------------------------------------------------------------------
4                    |222.2                     |null                      |
-------------------------------------------------------------------------
5                    |4.14                      |null                      |
-------------------------------------------------------------------------
6                    |80.6                      |null                      |
总数目：6
}

Elapsed Time: 0.0.9

-- [1]54:select max_by(time,s3) from root.sg.**
STRICT{
max_by(Time, root.sg.d1.s3)(INT64)      |max_by(Time, root.sg.d2.s3)(INT64)      |
--------------------------------------------------------------------------------
4                                       |1                                       |
总数目：1
}

Elapsed Time: 0.0.11

-- [1]55:select s4 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s4(INT64)      |root.sg.d2.s4(INT64)      |
-------------------------------------------------------------------------
1                    |12                        |16                        |
-------------------------------------------------------------------------
2                    |155                       |66                        |
-------------------------------------------------------------------------
3                    |12                        |360                       |
-------------------------------------------------------------------------
4                    |1010                      |null                      |
-------------------------------------------------------------------------
5                    |188                       |null                      |
-------------------------------------------------------------------------
6                    |2500                      |null                      |
-------------------------------------------------------------------------
7                    |3610                      |null                      |
总数目：7
}

Elapsed Time: 0.0.9

-- [1]56:select max_by(time,s4) from root.sg.**
STRICT{
max_by(Time, root.sg.d1.s4)(INT64)      |max_by(Time, root.sg.d2.s4)(INT64)      |
--------------------------------------------------------------------------------
7                                       |3                                       |
总数目：1
}

Elapsed Time: 0.0.11

-- [1]57:select s5 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s5(BOOLEAN)      |root.sg.d2.s5(BOOLEAN)      |
-----------------------------------------------------------------------------
1                    |false                       |true                        |
-----------------------------------------------------------------------------
2                    |true                        |false                       |
-----------------------------------------------------------------------------
3                    |false                       |true                        |
-----------------------------------------------------------------------------
4                    |true                        |null                        |
-----------------------------------------------------------------------------
5                    |false                       |null                        |
-----------------------------------------------------------------------------
6                    |true                        |null                        |
-----------------------------------------------------------------------------
7                    |false                       |null                        |
总数目：7
}

Elapsed Time: 0.0.11
-- [1]58:select max_by(time,s5) from root.sg.**
STRICT{
SQLSTATE : 301: Unsupported dataType: Unsupported data type in MaxBy/MinBy: BOOLEAN
}

-- [1]60:select s6 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s6(TEXT)      |root.sg.d2.s6(TEXT)      |
-----------------------------------------------------------------------
1                    |test01                   |A01Db                    |
-----------------------------------------------------------------------
2                    |test02                   |BNno10112Dnc             |
-----------------------------------------------------------------------
3                    |test03                   |LpNY10sdhj               |
-----------------------------------------------------------------------
4                    |test04                   |null                     |
-----------------------------------------------------------------------
5                    |test05                   |null                     |
-----------------------------------------------------------------------
6                    |test06                   |null                     |
-----------------------------------------------------------------------
7                    |test07                   |null                     |
总数目：7
}

Elapsed Time: 0.0.10
-- [1]61:select max_by(time,s6) from root.sg.**
STRICT{
SQLSTATE : 301: Unsupported dataType: Unsupported data type in MaxBy/MinBy: TEXT
}

-- [1]65:select s3, s4 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(FLOAT)      |root.sg.d2.s3(FLOAT)      |root.sg.d1.s4(INT64)      |root.sg.d2.s4(INT64)      |
-----------------------------------------------------------------------------------------------------------------------------
1                    |10.1                      |111.1                     |12                        |16                        |
-----------------------------------------------------------------------------------------------------------------------------
2                    |150.5                     |-1.1                      |155                       |66                        |
-----------------------------------------------------------------------------------------------------------------------------
3                    |10.1                      |55.5                      |12                        |360                       |
-----------------------------------------------------------------------------------------------------------------------------
4                    |222.2                     |null                      |1010                      |null                      |
-----------------------------------------------------------------------------------------------------------------------------
5                    |4.14                      |null                      |188                       |null                      |
-----------------------------------------------------------------------------------------------------------------------------
6                    |80.6                      |null                      |2500                      |null                      |
-----------------------------------------------------------------------------------------------------------------------------
7                    |null                      |null                      |3610                      |null                      |
总数目：7
}

Elapsed Time: 0.0.13

-- [1]66:select max_by(s3,s4) from root.sg.**
STRICT{
max_by(root.sg.d1.s3, root.sg.d1.s4)(FLOAT)      |max_by(root.sg.d1.s3, root.sg.d2.s4)(FLOAT)      |max_by(root.sg.d2.s3, root.sg.d1.s4)(FLOAT)      |max_by(root.sg.d2.s3, root.sg.d2.s4)(FLOAT)      |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
null                                             |10.1                                             |null                                             |55.5                                             |
总数目：1
}

Elapsed Time: 0.0.10

-- [1]69:select * from root.sg.d1 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s3(FLOAT)      |s4(INT64)      |s5(BOOLEAN)      |s6(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d1        |10.1           |12             |false            |test01        |100.1           |1              |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d1        |150.5          |155            |true             |test02        |60.2            |36             |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d1        |10.1           |12             |false            |test03        |255.6           |2              |
-----------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |222.2          |1010           |true             |test04        |0.2             |333            |
-----------------------------------------------------------------------------------------------------------------------------------
5                    |root.sg.d1        |4.14           |188            |false            |test05        |1.1             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
6                    |root.sg.d1        |80.6           |2500           |true             |test06        |255.6           |333            |
-----------------------------------------------------------------------------------------------------------------------------------
7                    |root.sg.d1        |null           |3610           |false            |test07        |16.6            |333            |
总数目：7
}

Elapsed Time: 0.0.8

-- [1]70:select max_by(time,s1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |max_by(Time, s1)(INT64)      |
-----------------------------------------------
root.sg.d1        |3                            |
总数目：1
}

Elapsed Time: 0.0.4

-- [1]71:select s1, s2 from root.sg.d1 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
----------------------------------------------------------------------
1                    |root.sg.d1        |100.1           |1              |
----------------------------------------------------------------------
2                    |root.sg.d1        |60.2            |36             |
----------------------------------------------------------------------
3                    |root.sg.d1        |255.6           |2              |
----------------------------------------------------------------------
4                    |root.sg.d1        |0.2             |333            |
----------------------------------------------------------------------
5                    |root.sg.d1        |1.1             |0              |
----------------------------------------------------------------------
6                    |root.sg.d1        |255.6           |333            |
----------------------------------------------------------------------
7                    |root.sg.d1        |16.6            |333            |
总数目：7
}

Elapsed Time: 0.0.5

-- [1]72:select max_by(s1,s2) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |max_by(s1, s2)(DOUBLE)      |
----------------------------------------------
root.sg.d1        |0.2                         |
总数目：1
}

Elapsed Time: 0.0.6

-- [1]75:select max_by(a,b) from root.sg.**
STRICT{
Time(TIMESTAMP)      |
总数目：0
}

Elapsed Time: 0.0.8
-- [1]76:select max_by(π,e) from root.sg.**
STRICT{
SQLSTATE : 700: Error occurred while parsing SQL to physical plan: line 1:14 token recognition error at: 'π'
}
-- [1]78:select max_by(1,2) from root.sg.**
STRICT{
SQLSTATE : 701: Invalid function expression, all the arguments are constant operands: max_by(1,2)
}
-- [1]80:select max_by(#,*)) from root.sg.**
STRICT{
SQLSTATE : 700: Error occurred while parsing SQL to physical plan: line 1:18 no viable alternative at input 'select max_by(#,*))'
}
-- [1]84:select max_by(time,s1,s2) from root.sg.**
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: max_by(Time, s1, s2), actual size: 3, expected size: [2].
}
-- [1]86:select max_by(s1,s2,s3,s4) from root.sg.**
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: max_by(s1, s2, s3, s4), actual size: 4, expected size: [2].
}
-- [1]88:select max_by(*) from root.sg.d1
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: max_by(*), actual size: 1, expected size: [2].
}

-- [1]92:select max_by(time,s1),max_value(s1) from root.sg.**
STRICT{
max_by(Time, root.sg.d1.s1)(INT64)      |max_by(Time, root.sg.d2.s1)(INT64)      |max_value(root.sg.d1.s1)(DOUBLE)      |max_value(root.sg.d2.s1)(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------
3                                       |2                                       |255.6                                 |155.5                                 |
总数目：1
}

Elapsed Time: 0.0.17

-- [1]93:select count(s1), max_by(s1,s4) from root.sg.**
STRICT{
count(root.sg.d1.s1)(INT64)      |count(root.sg.d2.s1)(INT64)      |max_by(root.sg.d1.s1, root.sg.d1.s4)(DOUBLE)      |max_by(root.sg.d1.s1, root.sg.d2.s4)(DOUBLE)      |max_by(root.sg.d2.s1, root.sg.d1.s4)(DOUBLE)      |max_by(root.sg.d2.s1, root.sg.d2.s4)(DOUBLE)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
7                                |3                                |16.6                                              |255.6                                             |null                                              |0.12                                              |
总数目：1
}

Elapsed Time: 0.0.12

-- [1]94:select max_by(s1,s3),sum(s1+s3),avg(s1+s3) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |max_by(s1, s3)(DOUBLE)      |sum(s1 + s3)(DOUBLE)      |avg(s1 + s3)(DOUBLE)      |
--------------------------------------------------------------------------------------------------
root.sg.d1        |0.2                         |1150.4399960517883        |191.7399993419647         |
总数目：1
}

Elapsed Time: 0.0.20

-- [1]95:select mode(*), max_by(s2,s4) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |mode(s3)(FLOAT)      |mode(s4)(INT64)      |mode(s5)(BOOLEAN)      |mode(s6)(TEXT)      |mode(s1)(DOUBLE)      |mode(s2)(INT32)      |max_by(s2, s4)(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1        |10.1                 |12                   |false                  |test01              |255.6                 |333                  |333                        |
总数目：1
}

Elapsed Time: 0.0.15
-- [1]98:select s1, s2, max_by(s1,s2) from root.sg.d1
STRICT{
SQLSTATE : 701: Raw data and aggregation hybrid query is not supported.
}

-- [1]102:select max_by(time+10-5,2*(s2+s3)-1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |max_by(Time + 10 - 5, 2 * (s2 + s3) - 1)(DOUBLE)      |
------------------------------------------------------------------------
root.sg.d1        |9.0                                                   |
总数目：1
}

Elapsed Time: 0.0.13

-- [1]103:select max_by(s2*2/3,s3+1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |max_by(s2 * 2 / 3, s3 + 1)(DOUBLE)      |
----------------------------------------------------------
root.sg.d1        |222.0                                   |
总数目：1
}

Elapsed Time: 0.0.10

-- [1]104:select max_by(s3+s4,s2-s1) as D001, avg(s1)+sum(s2)+1 as D002 from root.sg.d1 align by device
STRICT{
Device(TEXT)      |D001(DOUBLE)      |D002(DOUBLE)      |
------------------------------------------------------
root.sg.d1        |1232.1999969482422|1137.4857142857143|
总数目：1
}

Elapsed Time: 0.0.12

-- [1]107:select max_by(s1,s2) from root.sg.d1 group by ([0,10),2ms)
STRICT{
Time(TIMESTAMP)      |max_by(root.sg.d1.s1, root.sg.d1.s2)(DOUBLE)      |
-----------------------------------------------------------------------
0                    |100.1                                             |
-----------------------------------------------------------------------
2                    |60.2                                              |
-----------------------------------------------------------------------
4                    |0.2                                               |
-----------------------------------------------------------------------
6                    |255.6                                             |
-----------------------------------------------------------------------
8                    |null                                              |
总数目：5
}

Elapsed Time: 0.0.36

-- [1]108:select max_by(time,s4) from root.sg.** group by ([0,10),3ms)
STRICT{
Time(TIMESTAMP)      |max_by(Time, root.sg.d1.s4)(INT64)      |max_by(Time, root.sg.d2.s4)(INT64)      |
-----------------------------------------------------------------------------------------------------
0                    |2                                       |2                                       |
-----------------------------------------------------------------------------------------------------
3                    |4                                       |3                                       |
-----------------------------------------------------------------------------------------------------
6                    |7                                       |null                                    |
-----------------------------------------------------------------------------------------------------
9                    |null                                    |null                                    |
总数目：4
}

Elapsed Time: 0.0.20

-- [1]111:select max_by(s1,s3) from root.sg.d1 group by ([0,10),4ms) having max_by(s3,s2) > 10 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |max_by(s1, s3)(DOUBLE)      |
-------------------------------------------------------------------
0                    |root.sg.d1        |60.2                        |
-------------------------------------------------------------------
4                    |root.sg.d1        |0.2                         |
总数目：2
}

Elapsed Time: 0.0.9

-- [1]112:select max_by(s2,s3) from root.sg.d1 group by ([0,10),2ms) having max_by(time,s4) <=4 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |max_by(s2, s3)(INT32)      |
------------------------------------------------------------------
0                    |root.sg.d1        |1                          |
------------------------------------------------------------------
2                    |root.sg.d1        |36                         |
------------------------------------------------------------------
4                    |root.sg.d1        |333                        |
总数目：3
}

Elapsed Time: 0.0.6

-- [1]113:select max_by(s1,s2) from root.sg.d1 group by ([1,6),2ms) having sum(s1) > 1
STRICT{
Time(TIMESTAMP)      |max_by(root.sg.d1.s1, root.sg.d1.s2)(DOUBLE)      |
-----------------------------------------------------------------------
1                    |60.2                                              |
-----------------------------------------------------------------------
3                    |0.2                                               |
-----------------------------------------------------------------------
5                    |1.1                                               |
总数目：3
}

Elapsed Time: 0.0.6
-- [1]114:select max_by(s1,s2) from root.sg.d1 group by ([1,6),2ms) having s1 > 1
STRICT{
SQLSTATE : 701: Expression of HAVING clause must to be an Aggregation
}

-- [1]118:select max_by(s1,s2),max_by(s3,s4) from root.sg.** group by ([0,10),2ms) order by time desc align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |max_by(s1, s2)(DOUBLE)      |max_by(s3, s4)(FLOAT)      |
----------------------------------------------------------------------------------------------
8                    |root.sg.d1        |null                        |null                       |
----------------------------------------------------------------------------------------------
8                    |root.sg.d2        |null                        |null                       |
----------------------------------------------------------------------------------------------
6                    |root.sg.d1        |255.6                       |null                       |
----------------------------------------------------------------------------------------------
6                    |root.sg.d2        |null                        |null                       |
----------------------------------------------------------------------------------------------
4                    |root.sg.d1        |0.2                         |222.2                      |
----------------------------------------------------------------------------------------------
4                    |root.sg.d2        |null                        |null                       |
----------------------------------------------------------------------------------------------
2                    |root.sg.d1        |60.2                        |150.5                      |
----------------------------------------------------------------------------------------------
2                    |root.sg.d2        |155.5                       |55.5                       |
----------------------------------------------------------------------------------------------
0                    |root.sg.d1        |100.1                       |10.1                       |
----------------------------------------------------------------------------------------------
0                    |root.sg.d2        |1.1                         |111.1                      |
总数目：10
}

Elapsed Time: 0.0.19

-- [1]119:select max_by(time,s1),max_by(s1,s3),max_by(s3,s2),max_by(s4,s2) from root.sg.** group by([0,10),4ms) order by device desc,time asc align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |max_by(Time, s1)(INT64)      |max_by(s1, s3)(DOUBLE)      |max_by(s3, s2)(FLOAT)      |max_by(s4, s2)(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------
0                    |root.sg.d2        |2                            |1.1                         |111.1                      |16                         |
------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d2        |null                         |null                        |null                       |null                       |
------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d2        |null                         |null                        |null                       |null                       |
------------------------------------------------------------------------------------------------------------------------------------------------------
0                    |root.sg.d1        |3                            |60.2                        |150.5                      |155                        |
------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |6                            |0.2                         |222.2                      |1010                       |
------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d1        |null                         |null                        |null                       |null                       |
总数目：6
}

Elapsed Time: 0.0.11

-- [1]120:select max_by(s1,s2),max_by(s3,s4) from root.sg.** order by device asc, time desc limit 3 align by device
STRICT{
Device(TEXT)      |max_by(s1, s2)(DOUBLE)      |max_by(s3, s4)(FLOAT)      |
-------------------------------------------------------------------------
root.sg.d1        |0.2                         |null                       |
-------------------------------------------------------------------------
root.sg.d2        |1.1                         |55.5                       |
总数目：2
}

Elapsed Time: 0.0.14

-- [1]123:select max_by(s1,s2) from root.sg.d1 group by ([1,6),2ms),level=1 having sum(s1) > 1
STRICT{
Time(TIMESTAMP)      |max_by(root.sg.*.s1, root.sg.*.s2)(DOUBLE)      |
---------------------------------------------------------------------
1                    |60.2                                            |
---------------------------------------------------------------------
3                    |0.2                                             |
---------------------------------------------------------------------
5                    |1.1                                             |
总数目：3
}

Elapsed Time: 0.0.11

-- [1]124:select max_by(s3,s4) from root.sg.** group by ([1,10),2ms),level=2 having max_by(time,s1) > 2
STRICT{
Time(TIMESTAMP)      |max_by(root.*.d1.s3, root.*.d1.s4)(FLOAT)      |max_by(root.*.d1.s3, root.*.d2.s4)(FLOAT)      |max_by(root.*.d2.s3, root.*.d1.s4)(FLOAT)      |max_by(root.*.d2.s3, root.*.d2.s4)(FLOAT)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3                    |222.2                                          |10.1                                           |null                                           |55.5                                           |
总数目：1
}

Elapsed Time: 0.0.11
-- [1]125:select max_by(s1,s2) from root.** group by ([0,7),3ms),level=1 having sum(d1.s1) >1
STRICT{
SQLSTATE : 701: When Having used with GroupByLevel: the suffix paths can only be measurement or one-level wildcard
}

-- [1]129:select max_by(s1,s2) into root.sg.max_by.device(max_by_s1) from root.sg.d1
STRICT{
SourceColumn(TEXT)      |TargetTimeseries(TEXT)      |Written(INT64)      |
------------------------------------------------------------------------
max_by(root.sg.d1.s1, ro|root.sg.max_by.device.max_by|1                   |
ot.sg.d1.s2)            |_s1                         |                    |
总数目：1
}

Elapsed Time: 0.0.40

-- [1]130:show timeseries root.sg.max_by.device.**
STRICT{
Timeseries(TEXT)      |Alias(TEXT)      |Database(TEXT)      |DataType(TEXT)      |Encoding(TEXT)      |Compression(TEXT)      |Tags(TEXT)      |Attributes(TEXT)      |Deadband(TEXT)      |DeadbandParameters(TEXT)      |ViewType(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.max_by.device.|null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
max_by_s1             |                 |                    |                    |                    |                       |                |                      |                    |                              |                    |
总数目：1
}

Elapsed Time: 0.0.4

-- [1]131:select * from root.sg.max_by.device
STRICT{
Time(TIMESTAMP)      |root.sg.max_by.device.max_by_s1(DOUBLE)      |
------------------------------------------------------------------
0                    |0.2                                          |
总数目：1
}

Elapsed Time: 0.0.4
-- [1]134:create view root.view.device.max_by as select max_by(s1,s2) from root.sg.d1
STRICT{
SQLSTATE : 300: View unsupported, because: This view contains aggregation function(s) named [max_by(root.sg.d1.s1, root.sg.d1.s2)]
}

-- [1]138:select max_by(time, time_difference(*)) from root.sg.* align by device
STRICT{
Device(TEXT)      |max_by(Time, time_difference(s3))(INT64)      |max_by(Time, time_difference(s4))(INT64)      |max_by(Time, time_difference(s5))(INT64)      |max_by(Time, time_difference(s6))(INT64)      |max_by(Time, time_difference(s1))(INT64)      |max_by(Time, time_difference(s2))(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1        |2                                             |2                                             |2                                             |2                                             |2                                             |2                                             |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2        |2                                             |2                                             |2                                             |2                                             |2                                             |2                                             |
总数目：2
}

Elapsed Time: 0.0.46
