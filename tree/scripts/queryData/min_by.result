
-- [1]16:create database root.sg
STRICT{
PASS
}

-- [1]17:create timeseries root.sg.d1.s1 with datatype=DOUBLE
STRICT{
PASS
}

-- [1]18:create timeseries root.sg.d1.s2 with datatype=INT32
STRICT{
PASS
}

-- [1]19:create timeseries root.sg.d1.s3 with datatype=FLOAT
STRICT{
PASS
}

-- [1]20:create timeseries root.sg.d1.s4 with datatype=INT64
STRICT{
PASS
}

-- [1]21:create timeseries root.sg.d1.s5 with datatype=BOOLEAN
STRICT{
PASS
}

-- [1]22:create timeseries root.sg.d1.s6 with datatype=TEXT
STRICT{
PASS
}

-- [1]23:create aligned timeseries root.sg.d2(s1 DOUBLE, s2 INT32, s3 FLOAT, s4 INT64, s5 BOOLEAN, s6 TEXT)
STRICT{
PASS
}

-- [1]26:show databases root.sg
STRICT{
Database(TEXT)      |SchemaReplicationFactor(INT32)      |DataReplicationFactor(INT32)      |TimePartitionOrigin(INT64)      |TimePartitionInterval(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg             |1                                   |1                                 |0                               |604800000                         |
总数目：1
}
Elapsed Time: 0.0.1

-- [1]27:show devices root.sg.**
STRICT{
Device(TEXT)      |IsAligned(TEXT)      |Template(TEXT)      |TTL(ms)(TEXT)      |
------------------------------------------------------------------------------
root.sg.d1        |false                |null                |INF                |
------------------------------------------------------------------------------
root.sg.d2        |true                 |null                |INF                |
总数目：2
}
Elapsed Time: 0.0.6

-- [1]28:show timeseries root.sg.**
STRICT{
Timeseries(TEXT)      |Alias(TEXT)      |Database(TEXT)      |DataType(TEXT)      |Encoding(TEXT)      |Compression(TEXT)      |Tags(TEXT)      |Attributes(TEXT)      |Deadband(TEXT)      |DeadbandParameters(TEXT)      |ViewType(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s3         |null             |root.sg             |FLOAT               |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s4         |null             |root.sg             |INT64               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s5         |null             |root.sg             |BOOLEAN             |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s6         |null             |root.sg             |TEXT                |PLAIN               |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s1         |null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1.s2         |null             |root.sg             |INT32               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s3         |null             |root.sg             |FLOAT               |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s4         |null             |root.sg             |INT64               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s5         |null             |root.sg             |BOOLEAN             |RLE                 |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s6         |null             |root.sg             |TEXT                |PLAIN               |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s1         |null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2.s2         |null             |root.sg             |INT32               |TS_2DIFF            |LZ4                    |null            |null                  |null                |null                          |BASE                |
总数目：12
}
Elapsed Time: 0.0.4

-- [1]31:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(1,100.1,1,10.1,12,false,'test01')
STRICT{
0
}
Elapsed Time: 0.0.65

-- [1]32:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(2,60.2,36,150.5,155,true,'test02')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]33:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(3,0.2,2,10.1,12,false,'test03')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]34:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(4,0.2,0,222.2,1010,true,'test04')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]35:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(5,1.1,0,4.14,188,false,'test05')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]36:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(6,0.2,0,80.6,2500,true,'test06')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]37:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(7,16.6,25,null,3610,false,'test07')
STRICT{
0
}
Elapsed Time: 0.0.0

-- [1]38:insert into root.sg.d1(time,s1,s2,s3,s4,s5,s6) values(8,1.6,100,null,1,false,'test08')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]39:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(1,1.1,999,111.1,16,true,'A01Db')
STRICT{
0
}
Elapsed Time: 0.0.96

-- [1]40:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(2,155.5,101,-1.1,66,false,'BNno10112Dnc')
STRICT{
0
}
Elapsed Time: 0.0.2

-- [1]41:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(3,0.12,11,55.5,360,true,'LpNY10sdhj')
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]42:insert into root.sg.d2(time,s1,s2,s3,s4,s5,s6) values(4,0.12,20,null,5,true,'BNdhj')
STRICT{
0
}
Elapsed Time: 0.0.0

-- [1]47:select * from root.sg.** align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s3(FLOAT)      |s4(INT64)      |s5(BOOLEAN)      |s6(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d1        |10.1           |12             |false            |test01        |100.1           |1              |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d1        |150.5          |155            |true             |test02        |60.2            |36             |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d1        |10.1           |12             |false            |test03        |0.2             |2              |
-----------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |222.2          |1010           |true             |test04        |0.2             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
5                    |root.sg.d1        |4.14           |188            |false            |test05        |1.1             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
6                    |root.sg.d1        |80.6           |2500           |true             |test06        |0.2             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
7                    |root.sg.d1        |null           |3610           |false            |test07        |16.6            |25             |
-----------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d1        |null           |1              |false            |test08        |1.6             |100            |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d2        |111.1          |16             |true             |A01Db         |1.1             |999            |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d2        |-1.1           |66             |false            |BNno10112Dnc  |155.5           |101            |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d2        |55.5           |360            |true             |LpNY10sdhj    |0.12            |11             |
-----------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d2        |null           |5              |true             |BNdhj         |0.12            |20             |
总数目：12
}
Elapsed Time: 0.0.16

-- [1]50:select s1 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s1(DOUBLE)      |root.sg.d2.s1(DOUBLE)      |
---------------------------------------------------------------------------
1                    |100.1                      |1.1                        |
---------------------------------------------------------------------------
2                    |60.2                       |155.5                      |
---------------------------------------------------------------------------
3                    |0.2                        |0.12                       |
---------------------------------------------------------------------------
4                    |0.2                        |0.12                       |
---------------------------------------------------------------------------
5                    |1.1                        |null                       |
---------------------------------------------------------------------------
6                    |0.2                        |null                       |
---------------------------------------------------------------------------
7                    |16.6                       |null                       |
---------------------------------------------------------------------------
8                    |1.6                        |null                       |
总数目：8
}
Elapsed Time: 0.0.12

-- [1]51:select min_by(time,s1) from root.sg.**
STRICT{
min_by(Time, root.sg.d1.s1)(INT64)      |min_by(Time, root.sg.d2.s1)(INT64)      |
--------------------------------------------------------------------------------
3                                       |3                                       |
总数目：1
}
Elapsed Time: 0.0.14

-- [1]52:select s2 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s2(INT32)      |root.sg.d2.s2(INT32)      |
-------------------------------------------------------------------------
1                    |1                         |999                       |
-------------------------------------------------------------------------
2                    |36                        |101                       |
-------------------------------------------------------------------------
3                    |2                         |11                        |
-------------------------------------------------------------------------
4                    |0                         |20                        |
-------------------------------------------------------------------------
5                    |0                         |null                      |
-------------------------------------------------------------------------
6                    |0                         |null                      |
-------------------------------------------------------------------------
7                    |25                        |null                      |
-------------------------------------------------------------------------
8                    |100                       |null                      |
总数目：8
}
Elapsed Time: 0.0.9

-- [1]53:select min_by(time,s2) from root.sg.**
STRICT{
min_by(Time, root.sg.d1.s2)(INT64)      |min_by(Time, root.sg.d2.s2)(INT64)      |
--------------------------------------------------------------------------------
4                                       |3                                       |
总数目：1
}
Elapsed Time: 0.0.7

-- [1]54:select s3 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(FLOAT)      |root.sg.d2.s3(FLOAT)      |
-------------------------------------------------------------------------
1                    |10.1                      |111.1                     |
-------------------------------------------------------------------------
2                    |150.5                     |-1.1                      |
-------------------------------------------------------------------------
3                    |10.1                      |55.5                      |
-------------------------------------------------------------------------
4                    |222.2                     |null                      |
-------------------------------------------------------------------------
5                    |4.14                      |null                      |
-------------------------------------------------------------------------
6                    |80.6                      |null                      |
总数目：6
}
Elapsed Time: 0.0.6

-- [1]55:select min_by(time,s3) from root.sg.**
STRICT{
min_by(Time, root.sg.d1.s3)(INT64)      |min_by(Time, root.sg.d2.s3)(INT64)      |
--------------------------------------------------------------------------------
5                                       |2                                       |
总数目：1
}
Elapsed Time: 0.0.13

-- [1]56:select s4 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s4(INT64)      |root.sg.d2.s4(INT64)      |
-------------------------------------------------------------------------
1                    |12                        |16                        |
-------------------------------------------------------------------------
2                    |155                       |66                        |
-------------------------------------------------------------------------
3                    |12                        |360                       |
-------------------------------------------------------------------------
4                    |1010                      |5                         |
-------------------------------------------------------------------------
5                    |188                       |null                      |
-------------------------------------------------------------------------
6                    |2500                      |null                      |
-------------------------------------------------------------------------
7                    |3610                      |null                      |
-------------------------------------------------------------------------
8                    |1                         |null                      |
总数目：8
}
Elapsed Time: 0.0.7

-- [1]57:select min_by(time,s4) from root.sg.**
STRICT{
min_by(Time, root.sg.d1.s4)(INT64)      |min_by(Time, root.sg.d2.s4)(INT64)      |
--------------------------------------------------------------------------------
8                                       |4                                       |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]58:select s5 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s5(BOOLEAN)      |root.sg.d2.s5(BOOLEAN)      |
-----------------------------------------------------------------------------
1                    |false                       |true                        |
-----------------------------------------------------------------------------
2                    |true                        |false                       |
-----------------------------------------------------------------------------
3                    |false                       |true                        |
-----------------------------------------------------------------------------
4                    |true                        |true                        |
-----------------------------------------------------------------------------
5                    |false                       |null                        |
-----------------------------------------------------------------------------
6                    |true                        |null                        |
-----------------------------------------------------------------------------
7                    |false                       |null                        |
-----------------------------------------------------------------------------
8                    |false                       |null                        |
总数目：8
}
Elapsed Time: 0.0.8

-- [1]59:select min_by(time,s5) from root.sg.**
STRICT{
SQLSTATE : 301: Unsupported dataType: Unsupported data type in MaxBy/MinBy: BOOLEAN
}

-- [1]61:select s6 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s6(TEXT)      |root.sg.d2.s6(TEXT)      |
-----------------------------------------------------------------------
1                    |test01                   |A01Db                    |
-----------------------------------------------------------------------
2                    |test02                   |BNno10112Dnc             |
-----------------------------------------------------------------------
3                    |test03                   |LpNY10sdhj               |
-----------------------------------------------------------------------
4                    |test04                   |BNdhj                    |
-----------------------------------------------------------------------
5                    |test05                   |null                     |
-----------------------------------------------------------------------
6                    |test06                   |null                     |
-----------------------------------------------------------------------
7                    |test07                   |null                     |
-----------------------------------------------------------------------
8                    |test08                   |null                     |
总数目：8
}
Elapsed Time: 0.0.6

-- [1]62:select min_by(time,s6) from root.sg.**
STRICT{
SQLSTATE : 301: Unsupported dataType: Unsupported data type in MaxBy/MinBy: TEXT
}

-- [1]66:select s3, s4 from root.sg.**
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(FLOAT)      |root.sg.d2.s3(FLOAT)      |root.sg.d1.s4(INT64)      |root.sg.d2.s4(INT64)      |
-----------------------------------------------------------------------------------------------------------------------------
1                    |10.1                      |111.1                     |12                        |16                        |
-----------------------------------------------------------------------------------------------------------------------------
2                    |150.5                     |-1.1                      |155                       |66                        |
-----------------------------------------------------------------------------------------------------------------------------
3                    |10.1                      |55.5                      |12                        |360                       |
-----------------------------------------------------------------------------------------------------------------------------
4                    |222.2                     |null                      |1010                      |5                         |
-----------------------------------------------------------------------------------------------------------------------------
5                    |4.14                      |null                      |188                       |null                      |
-----------------------------------------------------------------------------------------------------------------------------
6                    |80.6                      |null                      |2500                      |null                      |
-----------------------------------------------------------------------------------------------------------------------------
7                    |null                      |null                      |3610                      |null                      |
-----------------------------------------------------------------------------------------------------------------------------
8                    |null                      |null                      |1                         |null                      |
总数目：8
}
Elapsed Time: 0.0.6

-- [1]67:select min_by(s3,s4) from root.sg.**
STRICT{
min_by(root.sg.d1.s3, root.sg.d1.s4)(FLOAT)      |min_by(root.sg.d1.s3, root.sg.d2.s4)(FLOAT)      |min_by(root.sg.d2.s3, root.sg.d1.s4)(FLOAT)      |min_by(root.sg.d2.s3, root.sg.d2.s4)(FLOAT)      |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
null                                             |222.2                                            |null                                             |null                                             |
总数目：1
}
Elapsed Time: 0.0.7

-- [1]70:select * from root.sg.d1 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s3(FLOAT)      |s4(INT64)      |s5(BOOLEAN)      |s6(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------
1                    |root.sg.d1        |10.1           |12             |false            |test01        |100.1           |1              |
-----------------------------------------------------------------------------------------------------------------------------------
2                    |root.sg.d1        |150.5          |155            |true             |test02        |60.2            |36             |
-----------------------------------------------------------------------------------------------------------------------------------
3                    |root.sg.d1        |10.1           |12             |false            |test03        |0.2             |2              |
-----------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |222.2          |1010           |true             |test04        |0.2             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
5                    |root.sg.d1        |4.14           |188            |false            |test05        |1.1             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
6                    |root.sg.d1        |80.6           |2500           |true             |test06        |0.2             |0              |
-----------------------------------------------------------------------------------------------------------------------------------
7                    |root.sg.d1        |null           |3610           |false            |test07        |16.6            |25             |
-----------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d1        |null           |1              |false            |test08        |1.6             |100            |
总数目：8
}
Elapsed Time: 0.0.5

-- [1]71:select min_by(time,s1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |min_by(Time, s1)(INT64)      |
-----------------------------------------------
root.sg.d1        |3                            |
总数目：1
}
Elapsed Time: 0.0.3

-- [1]72:select s1, s2 from root.sg.d1 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |s1(DOUBLE)      |s2(INT32)      |
----------------------------------------------------------------------
1                    |root.sg.d1        |100.1           |1              |
----------------------------------------------------------------------
2                    |root.sg.d1        |60.2            |36             |
----------------------------------------------------------------------
3                    |root.sg.d1        |0.2             |2              |
----------------------------------------------------------------------
4                    |root.sg.d1        |0.2             |0              |
----------------------------------------------------------------------
5                    |root.sg.d1        |1.1             |0              |
----------------------------------------------------------------------
6                    |root.sg.d1        |0.2             |0              |
----------------------------------------------------------------------
7                    |root.sg.d1        |16.6            |25             |
----------------------------------------------------------------------
8                    |root.sg.d1        |1.6             |100            |
总数目：8
}
Elapsed Time: 0.0.4

-- [1]73:select min_by(s1,s2) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |min_by(s1, s2)(DOUBLE)      |
----------------------------------------------
root.sg.d1        |0.2                         |
总数目：1
}
Elapsed Time: 0.0.3

-- [1]76:select min_by(a,b) from root.sg.**
STRICT{
Time(TIMESTAMP)      |
总数目：0
}
Elapsed Time: 0.0.3

-- [1]77:select min_by(π,e) from root.sg.**
STRICT{
SQLSTATE : 700: Error occurred while parsing SQL to physical plan: line 1:14 token recognition error at: 'π'
}

-- [1]79:select min_by(1,2) from root.sg.**
STRICT{
SQLSTATE : 701: Invalid function expression, all the arguments are constant operands: min_by(1,2)
}

-- [1]81:select min_by(#,*)) from root.sg.**
STRICT{
SQLSTATE : 700: Error occurred while parsing SQL to physical plan: line 1:18 no viable alternative at input 'select min_by(#,*))'
}

-- [1]85:select min_by(time,s1,s2) from root.sg.**
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: min_by(Time, s1, s2), actual size: 3, expected size: [2].
}

-- [1]87:select min_by(s1,s2,s3,s4) from root.sg.**
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: min_by(s1, s2, s3, s4), actual size: 4, expected size: [2].
}

-- [1]89:select min_by(*) from root.sg.d1
STRICT{
SQLSTATE : 701: Error size of input expressions. expression: min_by(*), actual size: 1, expected size: [2].
}

-- [1]93:select min_by(time,s1),max_value(s1) from root.sg.**
STRICT{
min_by(Time, root.sg.d1.s1)(INT64)      |min_by(Time, root.sg.d2.s1)(INT64)      |max_value(root.sg.d1.s1)(DOUBLE)      |max_value(root.sg.d2.s1)(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------
3                                       |3                                       |100.1                                 |155.5                                 |
总数目：1
}
Elapsed Time: 0.0.7

-- [1]94:select count(s1), min_by(s1,s4) from root.sg.**
STRICT{
count(root.sg.d1.s1)(INT64)      |count(root.sg.d2.s1)(INT64)      |min_by(root.sg.d1.s1, root.sg.d1.s4)(DOUBLE)      |min_by(root.sg.d1.s1, root.sg.d2.s4)(DOUBLE)      |min_by(root.sg.d2.s1, root.sg.d1.s4)(DOUBLE)      |min_by(root.sg.d2.s1, root.sg.d2.s4)(DOUBLE)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
8                                |4                                |1.6                                               |0.2                                               |null                                              |0.12                                              |
总数目：1
}
Elapsed Time: 0.0.8

-- [1]95:select min_by(s1,s3),sum(s1+s3),avg(s1+s3) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |min_by(s1, s3)(DOUBLE)      |sum(s1 + s3)(DOUBLE)      |avg(s1 + s3)(DOUBLE)      |
--------------------------------------------------------------------------------------------------
root.sg.d1        |1.1                         |639.6399960517883         |106.6066660086314         |
总数目：1
}
Elapsed Time: 0.0.8

-- [1]96:select mode(*), min_by(s2,s4) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |mode(s3)(FLOAT)      |mode(s4)(INT64)      |mode(s5)(BOOLEAN)      |mode(s6)(TEXT)      |mode(s1)(DOUBLE)      |mode(s2)(INT32)      |min_by(s2, s4)(INT32)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1        |10.1                 |12                   |false                  |test01              |0.2                   |0                    |100                        |
总数目：1
}
Elapsed Time: 0.0.14

-- [1]99:select s1, s2, min_by(s1,s2) from root.sg.d1
STRICT{
SQLSTATE : 701: Raw data and aggregation hybrid query is not supported.
}

-- [1]103:select min_by(time+10-5,2*(s2+s3)-1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |min_by(Time + 10 - 5, 2 * (s2 + s3) - 1)(DOUBLE)      |
------------------------------------------------------------------------
root.sg.d1        |10.0                                                  |
总数目：1
}
Elapsed Time: 0.0.13

-- [1]104:select min_by(s2*2/3,s3+1) from root.sg.d1 align by device
STRICT{
Device(TEXT)      |min_by(s2 * 2 / 3, s3 + 1)(DOUBLE)      |
----------------------------------------------------------
root.sg.d1        |0.0                                     |
总数目：1
}
Elapsed Time: 0.0.10

-- [1]105:select min_by(s3+s4,s2-s1) as D001, avg(s1)+sum(s2)+1 as D002 from root.sg.d1 align by device
STRICT{
Device(TEXT)      |D001(DOUBLE)      |D002(DOUBLE)      |
------------------------------------------------------
root.sg.d1        |22.100000381469727|187.525           |
总数目：1
}
Elapsed Time: 0.0.14

-- [1]108:select min_by(s1,s2) from root.sg.d1 group by ([0,10),2ms)
STRICT{
Time(TIMESTAMP)      |min_by(root.sg.d1.s1, root.sg.d1.s2)(DOUBLE)      |
-----------------------------------------------------------------------
0                    |100.1                                             |
-----------------------------------------------------------------------
2                    |0.2                                               |
-----------------------------------------------------------------------
4                    |0.2                                               |
-----------------------------------------------------------------------
6                    |0.2                                               |
-----------------------------------------------------------------------
8                    |1.6                                               |
总数目：5
}
Elapsed Time: 0.0.5

-- [1]109:select min_by(time,s4) from root.sg.** group by ([0,10),3ms)
STRICT{
Time(TIMESTAMP)      |min_by(Time, root.sg.d1.s4)(INT64)      |min_by(Time, root.sg.d2.s4)(INT64)      |
-----------------------------------------------------------------------------------------------------
0                    |1                                       |1                                       |
-----------------------------------------------------------------------------------------------------
3                    |3                                       |4                                       |
-----------------------------------------------------------------------------------------------------
6                    |8                                       |null                                    |
-----------------------------------------------------------------------------------------------------
9                    |null                                    |null                                    |
总数目：4
}
Elapsed Time: 0.0.11

-- [1]112:select min_by(s1,s3) from root.sg.d1 group by ([0,10),4ms) having min_by(s3,s2) > 10 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |min_by(s1, s3)(DOUBLE)      |
-------------------------------------------------------------------
0                    |root.sg.d1        |100.1                       |
-------------------------------------------------------------------
4                    |root.sg.d1        |1.1                         |
总数目：2
}
Elapsed Time: 0.0.10

-- [1]113:select min_by(s2,s3) from root.sg.d1 group by ([0,10),2ms) having min_by(time,s4) <=4 align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |min_by(s2, s3)(INT32)      |
------------------------------------------------------------------
0                    |root.sg.d1        |1                          |
------------------------------------------------------------------
2                    |root.sg.d1        |2                          |
总数目：2
}
Elapsed Time: 0.0.6

-- [1]114:select min_by(s1,s2) from root.sg.d1 group by ([1,6),2ms) having sum(s1) > 1
STRICT{
Time(TIMESTAMP)      |min_by(root.sg.d1.s1, root.sg.d1.s2)(DOUBLE)      |
-----------------------------------------------------------------------
1                    |100.1                                             |
-----------------------------------------------------------------------
5                    |1.1                                               |
总数目：2
}
Elapsed Time: 0.0.5

-- [1]115:select min_by(s1,s2) from root.sg.d1 group by ([1,6),2ms) having s1 > 1
STRICT{
SQLSTATE : 701: Expression of HAVING clause must to be an Aggregation
}

-- [1]119:select min_by(s1,s2),min_by(s3,s4) from root.sg.** group by ([0,10),2ms) order by time desc align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |min_by(s1, s2)(DOUBLE)      |min_by(s3, s4)(FLOAT)      |
----------------------------------------------------------------------------------------------
8                    |root.sg.d1        |1.6                         |null                       |
----------------------------------------------------------------------------------------------
8                    |root.sg.d2        |null                        |null                       |
----------------------------------------------------------------------------------------------
6                    |root.sg.d1        |0.2                         |80.6                       |
----------------------------------------------------------------------------------------------
6                    |root.sg.d2        |null                        |null                       |
----------------------------------------------------------------------------------------------
4                    |root.sg.d1        |0.2                         |4.14                       |
----------------------------------------------------------------------------------------------
4                    |root.sg.d2        |0.12                        |null                       |
----------------------------------------------------------------------------------------------
2                    |root.sg.d1        |0.2                         |10.1                       |
----------------------------------------------------------------------------------------------
2                    |root.sg.d2        |0.12                        |-1.1                       |
----------------------------------------------------------------------------------------------
0                    |root.sg.d1        |100.1                       |10.1                       |
----------------------------------------------------------------------------------------------
0                    |root.sg.d2        |1.1                         |111.1                      |
总数目：10
}
Elapsed Time: 0.0.18

-- [1]120:select min_by(time,s1),min_by(s1,s3),min_by(s3,s2),min_by(s4,s2) from root.sg.** group by([0,10),4ms) order by device desc,time asc align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |min_by(Time, s1)(INT64)      |min_by(s1, s3)(DOUBLE)      |min_by(s3, s2)(FLOAT)      |min_by(s4, s2)(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------
0                    |root.sg.d2        |3                            |155.5                       |55.5                       |360                        |
------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d2        |4                            |null                        |null                       |5                          |
------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d2        |null                         |null                        |null                       |null                       |
------------------------------------------------------------------------------------------------------------------------------------------------------
0                    |root.sg.d1        |3                            |100.1                       |10.1                       |12                         |
------------------------------------------------------------------------------------------------------------------------------------------------------
4                    |root.sg.d1        |4                            |1.1                         |222.2                      |1010                       |
------------------------------------------------------------------------------------------------------------------------------------------------------
8                    |root.sg.d1        |8                            |null                        |null                       |1                          |
总数目：6
}
Elapsed Time: 0.0.14

-- [1]121:select min_by(s1,s2),min_by(s3,s4) from root.sg.** order by device asc, time desc limit 1 align by device
STRICT{
Device(TEXT)      |min_by(s1, s2)(DOUBLE)      |min_by(s3, s4)(FLOAT)      |
-------------------------------------------------------------------------
root.sg.d1        |0.2                         |null                       |
总数目：1
}
Elapsed Time: 0.0.12

-- [1]124:select min_by(s1,s2) from root.sg.d1 group by ([1,6),2ms),level=1 having sum(s1) > 1
STRICT{
Time(TIMESTAMP)      |min_by(root.sg.*.s1, root.sg.*.s2)(DOUBLE)      |
---------------------------------------------------------------------
1                    |100.1                                           |
---------------------------------------------------------------------
5                    |1.1                                             |
总数目：2
}
Elapsed Time: 0.0.17

-- [1]125:select min_by(s3,s4) from root.sg.** group by ([1,10),2ms),level=2 having min_by(time,s1) > 2
STRICT{
Time(TIMESTAMP)      |min_by(root.*.d1.s3, root.*.d1.s4)(FLOAT)      |min_by(root.*.d1.s3, root.*.d2.s4)(FLOAT)      |min_by(root.*.d2.s3, root.*.d1.s4)(FLOAT)      |min_by(root.*.d2.s3, root.*.d2.s4)(FLOAT)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3                    |10.1                                           |222.2                                          |55.5                                           |null                                           |
总数目：1
}
Elapsed Time: 0.0.10

-- [1]126:select min_by(s1,s2) from root.** group by ([0,7),3ms),level=1 having sum(d1.s1) >1
STRICT{
SQLSTATE : 701: When Having used with GroupByLevel: the suffix paths can only be measurement or one-level wildcard
}

-- [1]130:select min_by(s1,s2) into root.sg.min_by.device(min_by_s1) from root.sg.d1
STRICT{
SourceColumn(TEXT)      |TargetTimeseries(TEXT)      |Written(INT64)      |
------------------------------------------------------------------------
min_by(root.sg.d1.s1, ro|root.sg.min_by.device.min_by|1                   |
ot.sg.d1.s2)            |_s1                         |                    |
总数目：1
}
Elapsed Time: 0.0.40

-- [1]131:show timeseries root.sg.min_by.device.**
STRICT{
Timeseries(TEXT)      |Alias(TEXT)      |Database(TEXT)      |DataType(TEXT)      |Encoding(TEXT)      |Compression(TEXT)      |Tags(TEXT)      |Attributes(TEXT)      |Deadband(TEXT)      |DeadbandParameters(TEXT)      |ViewType(TEXT)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.min_by.device.|null             |root.sg             |DOUBLE              |GORILLA             |LZ4                    |null            |null                  |null                |null                          |BASE                |
min_by_s1             |                 |                    |                    |                    |                       |                |                      |                    |                              |                    |
总数目：1
}
Elapsed Time: 0.0.5

-- [1]132:select * from root.sg.min_by.device
STRICT{
Time(TIMESTAMP)      |root.sg.min_by.device.min_by_s1(DOUBLE)      |
------------------------------------------------------------------
0                    |0.2                                          |
总数目：1
}
Elapsed Time: 0.0.5

-- [1]135:create view root.view.device.min_by as select min_by(s1,s2) from root.sg.d1
STRICT{
SQLSTATE : 300: View unsupported, because: This view contains aggregation function(s) named [min_by(root.sg.d1.s1, root.sg.d1.s2)]
}

-- [1]139:select min_by(time, time_difference(*)) from root.sg.* align by device
STRICT{
Device(TEXT)      |min_by(Time, time_difference(s3))(INT64)      |min_by(Time, time_difference(s4))(INT64)      |min_by(Time, time_difference(s5))(INT64)      |min_by(Time, time_difference(s6))(INT64)      |min_by(Time, time_difference(s1))(INT64)      |min_by(Time, time_difference(s2))(INT64)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d1        |2                                             |2                                             |2                                             |2                                             |2                                             |2                                             |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
root.sg.d2        |2                                             |2                                             |2                                             |2                                             |2                                             |2                                             |
总数目：2
}
Elapsed Time: 0.0.64
