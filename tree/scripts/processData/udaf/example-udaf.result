-- [1]11:create function my_avg as "org.example.UDAFExample"
STRICT{
PASS
}
-- [1]16:create database root.sg
STRICT{
PASS
}
-- [1]17:create aligned TIMESERIES root.sg.d0(s0 int32, s1 int64, s2 float, s3 double, s4 boolean, s5 text)
STRICT{
PASS
}
-- [1]38:insert into root.sg.d0(time, s0, s1, s2,s3,s4,s5) values(1,1,10,5.39,5.51234,true,'第1条'), (11,2,20,5.39,15.51234,false,'第2条'), (21,3,null,5.39,25.51234,true,'第3条'), (31,4,40,5.39,35.51234,true,'第4条'), (41,5,50,5.39,45.51234,false,'第5条'), (51,6,60,5.39,55.51234,false,'第6条'), (61,7,70,5.39,65.51234,false,'第7条'), (71,8,80,5.39,75.51234,false,'第8条'), (81,9,90,5.39,85.51234,false,'第9条'), (91,10,100,5.39,95.51234,false,'第10条'), (101,11,110,5.39,105.51234,false,'第11条'), (111,12,120,5.39,115.51234,false,'第12条'), (121,13,130,5.39,125.51234,false,'第13条'), (131,14,140,5.39,135.51234,false,'第14条'), (141,15,150,5.39,145.51234,false,'第15条'), (151,16,160,5.39,155.51234,false,'第16条'), (161,17,170,5.39,165.51234,false,'第17条'), (171,18,180,5.39,175.51234,false,'第18条'), (181,19,190,5.39,185.51234,false,'第19条'), (191,20,200,5.39,195.51234,false,'第20条'), (201,21,210,5.39,null,false,'第21条')
STRICT{
0
}

Elapsed Time: 0.0.320

-- [1]41:select s0,s1,s2,s3 into root.sg.d1(::) from root.sg.d0
STRICT{
SourceColumn(TEXT)      |TargetTimeseries(TEXT)      |Written(INT64)      |
------------------------------------------------------------------------
root.sg.d0.s0           |root.sg.d1.s0               |21                  |
------------------------------------------------------------------------
root.sg.d0.s1           |root.sg.d1.s1               |20                  |
------------------------------------------------------------------------
root.sg.d0.s2           |root.sg.d1.s2               |21                  |
------------------------------------------------------------------------
root.sg.d0.s3           |root.sg.d1.s3               |20                  |
总数目：4
}

Elapsed Time: 0.0.194

-- [1]42:select * into root.sg.group.d2(::) from root.sg.d0
STRICT{
SourceColumn(TEXT)      |TargetTimeseries(TEXT)      |Written(INT64)      |
------------------------------------------------------------------------
root.sg.d0.s3           |root.sg.group.d2.s3         |20                  |
------------------------------------------------------------------------
root.sg.d0.s4           |root.sg.group.d2.s4         |21                  |
------------------------------------------------------------------------
root.sg.d0.s5           |root.sg.group.d2.s5         |21                  |
------------------------------------------------------------------------
root.sg.d0.s0           |root.sg.group.d2.s0         |21                  |
------------------------------------------------------------------------
root.sg.d0.s1           |root.sg.group.d2.s1         |20                  |
------------------------------------------------------------------------
root.sg.d0.s2           |root.sg.group.d2.s2         |21                  |
总数目：6
}

Elapsed Time: 0.0.45

-- [1]47:show devices root.sg.**
STRICT{
Device(TEXT)      |IsAligned(TEXT)      |Template(TEXT)      |TTL(ms)(TEXT)      |
------------------------------------------------------------------------------
root.sg.d0        |true                 |null                |INF                |
------------------------------------------------------------------------------
root.sg.d1        |false                |null                |INF                |
------------------------------------------------------------------------------
root.sg.group.d2  |false                |null                |INF                |
总数目：3
}

Elapsed Time: 0.0.17

-- [1]48:select * from root.sg.d0
STRICT{
Time(TIMESTAMP)      |root.sg.d0.s3(DOUBLE)      |root.sg.d0.s4(BOOLEAN)      |root.sg.d0.s5(TEXT)      |root.sg.d0.s0(INT32)      |root.sg.d0.s1(INT64)      |root.sg.d0.s2(FLOAT)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                    |5.51234                    |true                        |第1条                      |1                         |10                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
11                   |15.51234                   |false                       |第2条                      |2                         |20                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
21                   |25.51234                   |true                        |第3条                      |3                         |null                      |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
31                   |35.51234                   |true                        |第4条                      |4                         |40                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
41                   |45.51234                   |false                       |第5条                      |5                         |50                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
51                   |55.51234                   |false                       |第6条                      |6                         |60                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
61                   |65.51234                   |false                       |第7条                      |7                         |70                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
71                   |75.51234                   |false                       |第8条                      |8                         |80                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
81                   |85.51234                   |false                       |第9条                      |9                         |90                        |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
91                   |95.51234                   |false                       |第10条                     |10                        |100                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                  |105.51234                  |false                       |第11条                     |11                        |110                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
111                  |115.51234                  |false                       |第12条                     |12                        |120                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
121                  |125.51234                  |false                       |第13条                     |13                        |130                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
131                  |135.51234                  |false                       |第14条                     |14                        |140                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
141                  |145.51234                  |false                       |第15条                     |15                        |150                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
151                  |155.51234                  |false                       |第16条                     |16                        |160                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
161                  |165.51234                  |false                       |第17条                     |17                        |170                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
171                  |175.51234                  |false                       |第18条                     |18                        |180                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
181                  |185.51234                  |false                       |第19条                     |19                        |190                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
191                  |195.51234                  |false                       |第20条                     |20                        |200                       |5.39                      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
201                  |null                       |false                       |第21条                     |21                        |210                       |5.39                      |
总数目：21
}

Elapsed Time: 0.0.10

-- [1]49:select * from root.sg.d1
STRICT{
Time(TIMESTAMP)      |root.sg.d1.s3(DOUBLE)      |root.sg.d1.s0(INT32)      |root.sg.d1.s1(INT64)      |root.sg.d1.s2(FLOAT)      |
------------------------------------------------------------------------------------------------------------------------------
1                    |5.51234                    |1                         |10                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
11                   |15.51234                   |2                         |20                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
21                   |25.51234                   |3                         |null                      |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
31                   |35.51234                   |4                         |40                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
41                   |45.51234                   |5                         |50                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
51                   |55.51234                   |6                         |60                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
61                   |65.51234                   |7                         |70                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
71                   |75.51234                   |8                         |80                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
81                   |85.51234                   |9                         |90                        |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
91                   |95.51234                   |10                        |100                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
101                  |105.51234                  |11                        |110                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
111                  |115.51234                  |12                        |120                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
121                  |125.51234                  |13                        |130                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
131                  |135.51234                  |14                        |140                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
141                  |145.51234                  |15                        |150                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
151                  |155.51234                  |16                        |160                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
161                  |165.51234                  |17                        |170                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
171                  |175.51234                  |18                        |180                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
181                  |185.51234                  |19                        |190                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
191                  |195.51234                  |20                        |200                       |5.39                      |
------------------------------------------------------------------------------------------------------------------------------
201                  |null                       |21                        |210                       |5.39                      |
总数目：21
}

Elapsed Time: 0.0.81

-- [1]50:select * from root.sg.group.d2
STRICT{
Time(TIMESTAMP)      |root.sg.group.d2.s3(DOUBLE)      |root.sg.group.d2.s4(BOOLEAN)      |root.sg.group.d2.s5(TEXT)      |root.sg.group.d2.s0(INT32)      |root.sg.group.d2.s1(INT64)      |root.sg.group.d2.s2(FLOAT)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                    |5.51234                          |true                              |第1条                            |1                               |10                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
11                   |15.51234                         |false                             |第2条                            |2                               |20                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
21                   |25.51234                         |true                              |第3条                            |3                               |null                            |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
31                   |35.51234                         |true                              |第4条                            |4                               |40                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
41                   |45.51234                         |false                             |第5条                            |5                               |50                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
51                   |55.51234                         |false                             |第6条                            |6                               |60                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
61                   |65.51234                         |false                             |第7条                            |7                               |70                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
71                   |75.51234                         |false                             |第8条                            |8                               |80                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
81                   |85.51234                         |false                             |第9条                            |9                               |90                              |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
91                   |95.51234                         |false                             |第10条                           |10                              |100                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                  |105.51234                        |false                             |第11条                           |11                              |110                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
111                  |115.51234                        |false                             |第12条                           |12                              |120                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
121                  |125.51234                        |false                             |第13条                           |13                              |130                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
131                  |135.51234                        |false                             |第14条                           |14                              |140                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
141                  |145.51234                        |false                             |第15条                           |15                              |150                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
151                  |155.51234                        |false                             |第16条                           |16                              |160                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
161                  |165.51234                        |false                             |第17条                           |17                              |170                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
171                  |175.51234                        |false                             |第18条                           |18                              |180                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
181                  |185.51234                        |false                             |第19条                           |19                              |190                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
191                  |195.51234                        |false                             |第20条                           |20                              |200                             |5.39                            |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
201                  |null                             |false                             |第21条                           |21                              |210                             |5.39                            |
总数目：21
}

Elapsed Time: 0.0.21

-- [1]56:select __endTime,my_avg(s0) from root.sg.d0
STRICT{
__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
---------------------------------------------------------
9223372036854775807   |11.0                               |
总数目：1
}

Elapsed Time: 0.0.24

-- [1]59:select __endTime,my_avg(s1) from root.sg.d0
STRICT{
__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
---------------------------------------------------------
9223372036854775807   |114.0                              |
总数目：1
}

Elapsed Time: 0.0.5

-- [1]60:select my_avg(s0) as avg_s0,my_avg(s1) as avg_s1,my_avg(s2) as avg_s2, my_avg(s3) as avg_s3 from root.sg.d0
STRICT{
avg_s0(DOUBLE)      |avg_s1(DOUBLE)      |avg_s2(DOUBLE)      |avg_s3(DOUBLE)      |
--------------------------------------------------------------------------------
11.0                |114.0               |5.389999866485596   |100.51234           |
总数目：1
}

Elapsed Time: 0.0.8

-- [1]63:select my_avg(s0) as avg_s0,my_avg(s1) as avg_s1,my_avg(s2) as avg_s2, my_avg(s3) as avg_s3 from root.sg.** align by device
STRICT{
Device(TEXT)      |avg_s0(DOUBLE)      |avg_s1(DOUBLE)      |avg_s2(DOUBLE)      |avg_s3(DOUBLE)      |
--------------------------------------------------------------------------------------------------
root.sg.d0        |11.0                |114.0               |5.389999866485596   |100.51234           |
--------------------------------------------------------------------------------------------------
root.sg.d1        |11.0                |114.0               |5.389999866485596   |100.51234           |
--------------------------------------------------------------------------------------------------
root.sg.group.d2  |11.0                |114.0               |5.389999866485596   |100.51234           |
总数目：3
}

Elapsed Time: 0.0.35

-- [1]66:select my_avg(*) from root.sg.d1
STRICT{
my_avg(root.sg.d1.s3)(DOUBLE)      |my_avg(root.sg.d1.s0)(DOUBLE)      |my_avg(root.sg.d1.s1)(DOUBLE)      |my_avg(root.sg.d1.s2)(DOUBLE)      |
--------------------------------------------------------------------------------------------------------------------------------------------
100.51234                          |11.0                               |114.0                              |5.389999866485596                  |
总数目：1
}

Elapsed Time: 0.0.11

-- [1]67:select my_avg(s0)+count(s0) from root.sg.d1
STRICT{
my_avg(root.sg.d1.s0) + count(root.sg.d1.s0)(DOUBLE)      |
----------------------------------------------------------
32.0                                                      |
总数目：1
}

Elapsed Time: 0.0.27

-- [1]72:select  __endTime,my_avg(s0) from root.sg.d0 group by ([1,202),10ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |10                    |1.0                                |
------------------------------------------------------------------------------
11                   |20                    |2.0                                |
------------------------------------------------------------------------------
21                   |30                    |3.0                                |
------------------------------------------------------------------------------
31                   |40                    |4.0                                |
------------------------------------------------------------------------------
41                   |50                    |5.0                                |
------------------------------------------------------------------------------
51                   |60                    |6.0                                |
------------------------------------------------------------------------------
61                   |70                    |7.0                                |
------------------------------------------------------------------------------
71                   |80                    |8.0                                |
------------------------------------------------------------------------------
81                   |90                    |9.0                                |
------------------------------------------------------------------------------
91                   |100                   |10.0                               |
------------------------------------------------------------------------------
101                  |110                   |11.0                               |
------------------------------------------------------------------------------
111                  |120                   |12.0                               |
------------------------------------------------------------------------------
121                  |130                   |13.0                               |
------------------------------------------------------------------------------
131                  |140                   |14.0                               |
------------------------------------------------------------------------------
141                  |150                   |15.0                               |
------------------------------------------------------------------------------
151                  |160                   |16.0                               |
------------------------------------------------------------------------------
161                  |170                   |17.0                               |
------------------------------------------------------------------------------
171                  |180                   |18.0                               |
------------------------------------------------------------------------------
181                  |190                   |19.0                               |
------------------------------------------------------------------------------
191                  |200                   |20.0                               |
------------------------------------------------------------------------------
201                  |201                   |21.0                               |
总数目：21
}

Elapsed Time: 0.0.18

-- [1]75:select  __endTime,my_avg(s0) from root.sg.d0 group by ([1,202),10ms,20ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |10                    |1.0                                |
------------------------------------------------------------------------------
21                   |30                    |3.0                                |
------------------------------------------------------------------------------
41                   |50                    |5.0                                |
------------------------------------------------------------------------------
61                   |70                    |7.0                                |
------------------------------------------------------------------------------
81                   |90                    |9.0                                |
------------------------------------------------------------------------------
101                  |110                   |11.0                               |
------------------------------------------------------------------------------
121                  |130                   |13.0                               |
------------------------------------------------------------------------------
141                  |150                   |15.0                               |
------------------------------------------------------------------------------
161                  |170                   |17.0                               |
------------------------------------------------------------------------------
181                  |190                   |19.0                               |
------------------------------------------------------------------------------
201                  |201                   |21.0                               |
总数目：11
}

Elapsed Time: 0.0.6

-- [1]78:select  __endTime,my_avg(s0) from root.sg.d0 group by ([1,202),20ms,10ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |20                    |1.5                                |
------------------------------------------------------------------------------
11                   |30                    |2.5                                |
------------------------------------------------------------------------------
21                   |40                    |3.5                                |
------------------------------------------------------------------------------
31                   |50                    |4.5                                |
------------------------------------------------------------------------------
41                   |60                    |5.5                                |
------------------------------------------------------------------------------
51                   |70                    |6.5                                |
------------------------------------------------------------------------------
61                   |80                    |7.5                                |
------------------------------------------------------------------------------
71                   |90                    |8.5                                |
------------------------------------------------------------------------------
81                   |100                   |9.5                                |
------------------------------------------------------------------------------
91                   |110                   |10.5                               |
------------------------------------------------------------------------------
101                  |120                   |11.5                               |
------------------------------------------------------------------------------
111                  |130                   |12.5                               |
------------------------------------------------------------------------------
121                  |140                   |13.5                               |
------------------------------------------------------------------------------
131                  |150                   |14.5                               |
------------------------------------------------------------------------------
141                  |160                   |15.5                               |
------------------------------------------------------------------------------
151                  |170                   |16.5                               |
------------------------------------------------------------------------------
161                  |180                   |17.5                               |
------------------------------------------------------------------------------
171                  |190                   |18.5                               |
------------------------------------------------------------------------------
181                  |200                   |19.5                               |
------------------------------------------------------------------------------
191                  |201                   |20.5                               |
------------------------------------------------------------------------------
201                  |201                   |21.0                               |
总数目：21
}

Elapsed Time: 0.0.12

-- [1]81:select  __endTime,my_avg(s0) from root.sg.d0 group by ([1,202),1mo,2mo)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |201                   |11.0                               |
总数目：1
}

Elapsed Time: 0.0.10

-- [1]84:select  __endTime,my_avg(s0) from root.sg.d0 group by ((1,201],50ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s0)(DOUBLE)      |
------------------------------------------------------------------------------
51                   |51                    |4.0                                |
------------------------------------------------------------------------------
101                  |101                   |9.0                                |
------------------------------------------------------------------------------
151                  |151                   |14.0                               |
------------------------------------------------------------------------------
201                  |201                   |19.0                               |
总数目：4
}

Elapsed Time: 0.0.4

-- [1]88:select  __endTime,my_avg(s0) from root.sg.** group by ((0,201],80ms), level=0
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.*.*.s0)(DOUBLE)      |my_avg(root.*.*.*.s0)(DOUBLE)      |
---------------------------------------------------------------------------------------------------------------
80                   |80                    |4.5                              |4.5                                |
---------------------------------------------------------------------------------------------------------------
160                  |160                   |12.5                             |12.5                               |
---------------------------------------------------------------------------------------------------------------
201                  |201                   |19.0                             |19.0                               |
总数目：3
}

Elapsed Time: 0.0.20

-- [1]90:select  __endTime,my_avg(s0) from root.sg.** group by ((0,201],80ms), level=1
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.*.s0)(DOUBLE)      |my_avg(root.sg.*.*.s0)(DOUBLE)      |
-----------------------------------------------------------------------------------------------------------------
80                   |80                    |4.5                               |4.5                                 |
-----------------------------------------------------------------------------------------------------------------
160                  |160                   |12.5                              |12.5                                |
-----------------------------------------------------------------------------------------------------------------
201                  |201                   |19.0                              |19.0                                |
总数目：3
}

Elapsed Time: 0.0.9

-- [1]92:select  __endTime,my_avg(s0) from root.sg.** group by ((0,201],80ms), level=2
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.*.d0.s0)(DOUBLE)      |my_avg(root.*.d1.s0)(DOUBLE)      |my_avg(root.*.group.*.s0)(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------------------------------
80                   |80                    |4.5                               |4.5                               |4.5                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------
160                  |160                   |12.5                              |12.5                              |12.5                                   |
------------------------------------------------------------------------------------------------------------------------------------------------------
201                  |201                   |19.0                              |19.0                              |19.0                                   |
总数目：3
}

Elapsed Time: 0.0.9

-- [1]94:select  __endTime,my_avg(s0) from root.sg.** group by ((0,201],80ms), level=2,3
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.*.d0.s0)(DOUBLE)      |my_avg(root.*.d1.s0)(DOUBLE)      |my_avg(root.*.group.d2.s0)(DOUBLE)      |
-------------------------------------------------------------------------------------------------------------------------------------------------------
80                   |80                    |4.5                               |4.5                               |4.5                                     |
-------------------------------------------------------------------------------------------------------------------------------------------------------
160                  |160                   |12.5                              |12.5                              |12.5                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------
201                  |201                   |19.0                              |19.0                              |19.0                                    |
总数目：3
}

Elapsed Time: 0.0.9

-- [1]98:select my_avg(s0) from root.sg.** group by ((0,201],80ms) align by device
STRICT{
Time(TIMESTAMP)      |Device(TEXT)      |my_avg(s0)(DOUBLE)      |
---------------------------------------------------------------
80                   |root.sg.d0        |4.5                     |
---------------------------------------------------------------
160                  |root.sg.d0        |12.5                    |
---------------------------------------------------------------
201                  |root.sg.d0        |19.0                    |
---------------------------------------------------------------
80                   |root.sg.d1        |4.5                     |
---------------------------------------------------------------
160                  |root.sg.d1        |12.5                    |
---------------------------------------------------------------
201                  |root.sg.d1        |19.0                    |
---------------------------------------------------------------
80                   |root.sg.group.d2  |4.5                     |
---------------------------------------------------------------
160                  |root.sg.group.d2  |12.5                    |
---------------------------------------------------------------
201                  |root.sg.group.d2  |19.0                    |
总数目：9
}

Elapsed Time: 0.0.8

-- [1]100:select  __endTime,my_avg(s2) from root.sg.** group by ((0,201],80ms), level=2 having max_value(s1)>100
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.*.d0.s2)(DOUBLE)      |my_avg(root.*.d1.s2)(DOUBLE)      |my_avg(root.*.group.*.s2)(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------------------------------
160                  |160                   |5.389999866485596                 |5.389999866485596                 |5.389999866485596                      |
------------------------------------------------------------------------------------------------------------------------------------------------------
201                  |201                   |5.389999866485596                 |5.389999866485596                 |5.389999866485596                      |
总数目：2
}

Elapsed Time: 0.0.18

-- [1]102:select  __endTime,my_avg(s2),count(s0) from root.sg.d1 group by ((0,201],80ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d1.s2)(DOUBLE)      |count(root.sg.d1.s0)(INT64)      |
---------------------------------------------------------------------------------------------------------------
80                   |80                    |5.389999866485596                  |8                                |
---------------------------------------------------------------------------------------------------------------
160                  |160                   |5.389999866485596                  |8                                |
---------------------------------------------------------------------------------------------------------------
201                  |201                   |5.389999866485596                  |5                                |
总数目：3
}

Elapsed Time: 0.0.6

-- [1]107:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s0,0)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |1                     |10.0                               |
------------------------------------------------------------------------------
11                   |11                    |20.0                               |
------------------------------------------------------------------------------
21                   |21                    |null                               |
------------------------------------------------------------------------------
31                   |31                    |40.0                               |
------------------------------------------------------------------------------
41                   |41                    |50.0                               |
------------------------------------------------------------------------------
51                   |51                    |60.0                               |
------------------------------------------------------------------------------
61                   |61                    |70.0                               |
------------------------------------------------------------------------------
71                   |71                    |80.0                               |
------------------------------------------------------------------------------
81                   |81                    |90.0                               |
------------------------------------------------------------------------------
91                   |91                    |100.0                              |
------------------------------------------------------------------------------
101                  |101                   |110.0                              |
------------------------------------------------------------------------------
111                  |111                   |120.0                              |
------------------------------------------------------------------------------
121                  |121                   |130.0                              |
------------------------------------------------------------------------------
131                  |131                   |140.0                              |
------------------------------------------------------------------------------
141                  |141                   |150.0                              |
------------------------------------------------------------------------------
151                  |151                   |160.0                              |
------------------------------------------------------------------------------
161                  |161                   |170.0                              |
------------------------------------------------------------------------------
171                  |171                   |180.0                              |
------------------------------------------------------------------------------
181                  |181                   |190.0                              |
------------------------------------------------------------------------------
191                  |191                   |200.0                              |
------------------------------------------------------------------------------
201                  |201                   |210.0                              |
总数目：21
}

Elapsed Time: 0.0.5

-- [1]109:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s5)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |1                     |10.0                               |
------------------------------------------------------------------------------
11                   |11                    |20.0                               |
------------------------------------------------------------------------------
21                   |21                    |null                               |
------------------------------------------------------------------------------
31                   |31                    |40.0                               |
------------------------------------------------------------------------------
41                   |41                    |50.0                               |
------------------------------------------------------------------------------
51                   |51                    |60.0                               |
------------------------------------------------------------------------------
61                   |61                    |70.0                               |
------------------------------------------------------------------------------
71                   |71                    |80.0                               |
------------------------------------------------------------------------------
81                   |81                    |90.0                               |
------------------------------------------------------------------------------
91                   |91                    |100.0                              |
------------------------------------------------------------------------------
101                  |101                   |110.0                              |
------------------------------------------------------------------------------
111                  |111                   |120.0                              |
------------------------------------------------------------------------------
121                  |121                   |130.0                              |
------------------------------------------------------------------------------
131                  |131                   |140.0                              |
------------------------------------------------------------------------------
141                  |141                   |150.0                              |
------------------------------------------------------------------------------
151                  |151                   |160.0                              |
------------------------------------------------------------------------------
161                  |161                   |170.0                              |
------------------------------------------------------------------------------
171                  |171                   |180.0                              |
------------------------------------------------------------------------------
181                  |181                   |190.0                              |
------------------------------------------------------------------------------
191                  |191                   |200.0                              |
------------------------------------------------------------------------------
201                  |201                   |210.0                              |
总数目：21
}

Elapsed Time: 0.0.4

-- [1]111:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s4)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |1                     |10.0                               |
------------------------------------------------------------------------------
11                   |11                    |20.0                               |
------------------------------------------------------------------------------
21                   |31                    |40.0                               |
------------------------------------------------------------------------------
41                   |201                   |130.0                              |
总数目：4
}

Elapsed Time: 0.0.4

-- [1]113:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s1)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |1                     |10.0                               |
------------------------------------------------------------------------------
11                   |11                    |20.0                               |
------------------------------------------------------------------------------
31                   |31                    |40.0                               |
------------------------------------------------------------------------------
41                   |41                    |50.0                               |
------------------------------------------------------------------------------
51                   |51                    |60.0                               |
------------------------------------------------------------------------------
61                   |61                    |70.0                               |
------------------------------------------------------------------------------
71                   |71                    |80.0                               |
------------------------------------------------------------------------------
81                   |81                    |90.0                               |
------------------------------------------------------------------------------
91                   |91                    |100.0                              |
------------------------------------------------------------------------------
101                  |101                   |110.0                              |
------------------------------------------------------------------------------
111                  |111                   |120.0                              |
------------------------------------------------------------------------------
121                  |121                   |130.0                              |
------------------------------------------------------------------------------
131                  |131                   |140.0                              |
------------------------------------------------------------------------------
141                  |141                   |150.0                              |
------------------------------------------------------------------------------
151                  |151                   |160.0                              |
------------------------------------------------------------------------------
161                  |161                   |170.0                              |
------------------------------------------------------------------------------
171                  |171                   |180.0                              |
------------------------------------------------------------------------------
181                  |181                   |190.0                              |
------------------------------------------------------------------------------
191                  |191                   |200.0                              |
------------------------------------------------------------------------------
201                  |201                   |210.0                              |
总数目：20
}

Elapsed Time: 0.0.3

-- [1]117:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s0,1)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |11                    |15.0                               |
------------------------------------------------------------------------------
21                   |31                    |40.0                               |
------------------------------------------------------------------------------
41                   |51                    |55.0                               |
------------------------------------------------------------------------------
61                   |71                    |75.0                               |
------------------------------------------------------------------------------
81                   |91                    |95.0                               |
------------------------------------------------------------------------------
101                  |111                   |115.0                              |
------------------------------------------------------------------------------
121                  |131                   |135.0                              |
------------------------------------------------------------------------------
141                  |151                   |155.0                              |
------------------------------------------------------------------------------
161                  |171                   |175.0                              |
------------------------------------------------------------------------------
181                  |191                   |195.0                              |
------------------------------------------------------------------------------
201                  |201                   |210.0                              |
总数目：11
}

Elapsed Time: 0.0.4

-- [1]119:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s0,2)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |21                    |15.0                               |
------------------------------------------------------------------------------
31                   |51                    |50.0                               |
------------------------------------------------------------------------------
61                   |81                    |80.0                               |
------------------------------------------------------------------------------
91                   |111                   |110.0                              |
------------------------------------------------------------------------------
121                  |141                   |140.0                              |
------------------------------------------------------------------------------
151                  |171                   |170.0                              |
------------------------------------------------------------------------------
181                  |201                   |200.0                              |
总数目：7
}

Elapsed Time: 0.0.11

-- [1]120:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s1,20)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |11                    |15.0                               |
------------------------------------------------------------------------------
31                   |51                    |50.0                               |
------------------------------------------------------------------------------
61                   |81                    |80.0                               |
------------------------------------------------------------------------------
91                   |111                   |110.0                              |
------------------------------------------------------------------------------
121                  |141                   |140.0                              |
------------------------------------------------------------------------------
151                  |171                   |170.0                              |
------------------------------------------------------------------------------
181                  |201                   |200.0                              |
总数目：7
}

Elapsed Time: 0.0.4

-- [1]122:select __endTime, my_avg(s1) from root.sg.d0 group by variation(s0,40)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |201                   |114.0                              |
总数目：1
}

Elapsed Time: 0.0.9

-- [1]127:select __endTime, my_avg(s1) from root.sg.d0 group by condition(s4=false, KEEP>=1)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
11                   |11                    |20.0                               |
------------------------------------------------------------------------------
41                   |201                   |130.0                              |
总数目：2
}

Elapsed Time: 0.0.6

-- [1]129:select __endTime, my_avg(s1) from root.sg.d0 group by condition(s4=false, KEEP>=2)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
41                   |201                   |130.0                              |
总数目：1
}

Elapsed Time: 0.0.8

-- [1]132:select __endTime, my_avg(s1) from root.sg.d0 group by session(10ms)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |11                    |15.0                               |
------------------------------------------------------------------------------
31                   |201                   |125.0                              |
总数目：2
}

Elapsed Time: 0.0.4

-- [1]136:select __endTime, my_avg(s1) from root.sg.d0 group by count(s0,5)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |41                    |30.0                               |
------------------------------------------------------------------------------
51                   |91                    |80.0                               |
------------------------------------------------------------------------------
101                  |141                   |130.0                              |
------------------------------------------------------------------------------
151                  |191                   |180.0                              |
总数目：4
}

Elapsed Time: 0.0.5

-- [1]137:select __endTime, my_avg(s1) from root.sg.d0 group by count(s1,5)
STRICT{
Time(TIMESTAMP)      |__endTime(INT64)      |my_avg(root.sg.d0.s1)(DOUBLE)      |
------------------------------------------------------------------------------
1                    |51                    |36.0                               |
------------------------------------------------------------------------------
61                   |101                   |90.0                               |
------------------------------------------------------------------------------
111                  |151                   |140.0                              |
------------------------------------------------------------------------------
161                  |201                   |190.0                              |
总数目：4
}

Elapsed Time: 0.0.3
-- [1]151:select __endTime,my_avg(s4) from root.sg.d0
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
org.apache.iotdb.udf.api.exception.UDFInputSeriesDataTypeNotValidException: the data type of the input series (index: 0) is not valid. expected: [INT32, INT64, FLOAT, DOUBLE]. actual: BOOLEAN.
}
-- [1]153:select __endTime,my_avg(s5) from root.sg.d0
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
org.apache.iotdb.udf.api.exception.UDFInputSeriesDataTypeNotValidException: the data type of the input series (index: 0) is not valid. expected: [INT32, INT64, FLOAT, DOUBLE]. actual: TEXT.
}
-- [1]157:select max_value(my_avg(s0)) from root.sg.d0 group by ([1,202),100ms)
STRICT{
SQLSTATE : 701: Aggregation results cannot be as input of the aggregation function.
}
-- [1]161:select my_avg(max_value(s0)) from root.sg.d0 group by ([1,202),100ms)
STRICT{
SQLSTATE : 701: Aggregation results cannot be as input of the aggregation function.
}
-- [1]165:select my_avgg(s0) from root.sg.d0
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
org.apache.iotdb.udf.api.exception.UDFException: Failed to reflect UDF instance, because UDF MY_AVGG has not been registered.
}
-- [1]171:drop function my_avg
STRICT{
PASS
}
