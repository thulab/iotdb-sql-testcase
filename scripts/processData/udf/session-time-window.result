-- [1]9:create function count_sec as "com.timecho.udf.normal.TestSessionTimeWindowAccessStrategy"
STRICT{
PASS
}
-- [1]13:CREATE TIMESERIES root.udf.d1.s1 WITH DATATYPE=text, ENCODING=PLAIN
STRICT{
PASS
}
-- [1]14:CREATE TIMESERIES root.udf.d1.s2 WITH DATATYPE=text, ENCODING=PLAIN
STRICT{
PASS
}

-- [1]15:select count_sec(s1, 'max_interval'='3', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="3", "standard"="udf")(FLOAT)      |
总数目：0
}

Elapsed Time: 0.0.3
-- [1]17:insert into root.udf.d1 (time, s1, s2) values (1, 'udf', 'trigger'),(2, 'some' , 'old'),(3, null, 'trigger'),(9, 'udf', 'new'),(5, 'woman', 'udf'),(12, 'trigger', null),(14, 'udf', 14),(18, 'udf', 16),(21, 'trigger', 18),(24, 'udf', 20)
STRICT{
0
}

Elapsed Time: 0.0.260

-- [1]19:select * from root.udf.d1
STRICT{
Time(TIME)      |root.udf.d1.s1(TEXT)      |root.udf.d1.s2(TEXT)      |
--------------------------------------------------------------------
1               |udf                       |trigger                   |
--------------------------------------------------------------------
2               |some                      |old                       |
--------------------------------------------------------------------
3               |null                      |trigger                   |
--------------------------------------------------------------------
5               |woman                     |udf                       |
--------------------------------------------------------------------
9               |udf                       |new                       |
--------------------------------------------------------------------
12              |trigger                   |null                      |
--------------------------------------------------------------------
14              |udf                       |14                        |
--------------------------------------------------------------------
18              |udf                       |16                        |
--------------------------------------------------------------------
21              |trigger                   |18                        |
--------------------------------------------------------------------
24              |udf                       |20                        |
总数目：10
}

Elapsed Time: 0.0.3
-- [1]22:select count_sec(s1, 'max_interval'=1, 'standard'=udf) from root.udf.d1
STRICT{
SQLSTATE : 507: Check metadata error: Attributes of functions should be quoted with '' or ""
}
-- [1]23:select count_sec(s1, 'max_interval'=1, 'standard'='udf') from root.udf.d1
STRICT{
SQLSTATE : 507: Check metadata error: Attributes of functions should be quoted with '' or ""
}
-- [1]24:select count_sec(s1, 'max_interval'=`1`, 'standard'=`udf`) from root.udf.d1
STRICT{
SQLSTATE : 507: Check metadata error: Attributes of functions should be quoted with '' or ""
}

-- [1]25:select count_sec(s1, 'max_interval'='1', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |0.0                                                                         |
--------------------------------------------------------------------------------------------
14              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：8
}

Elapsed Time: 0.0.3

-- [1]26:select count_sec(s1, 'max_interval'="1", 'standard'="udf") from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |0.0                                                                         |
--------------------------------------------------------------------------------------------
14              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：8
}

Elapsed Time: 0.0.4
-- [1]28:select count_sec(s1, 'max_interval'='1', 'standard'=null) from root.udf.d1
STRICT{
SQLSTATE : 507: Check metadata error: Unsupported constant operand: null
}

-- [1]29:select count_sec(s1, 'max_interval'='1', 'standard'='null') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="null")(FLOAT)      |
---------------------------------------------------------------------------------------------
1               |0.0                                                                          |
---------------------------------------------------------------------------------------------
5               |0.0                                                                          |
---------------------------------------------------------------------------------------------
9               |0.0                                                                          |
---------------------------------------------------------------------------------------------
12              |0.0                                                                          |
---------------------------------------------------------------------------------------------
14              |0.0                                                                          |
---------------------------------------------------------------------------------------------
18              |0.0                                                                          |
---------------------------------------------------------------------------------------------
21              |0.0                                                                          |
---------------------------------------------------------------------------------------------
24              |0.0                                                                          |
总数目：8
}

Elapsed Time: 0.0.2
-- [1]31:select count_sec(s1, 'max_interval'='aa', 'standard'='udf') from root.udf.d1
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
java.lang.NumberFormatException: For input string: "aa"
}
-- [1]32:select count_sec(s1, 'max_interval'='1','standard'='udf','start'='start', 'end'='0') from root.udf.d1
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
java.lang.NumberFormatException: For input string: "start"
}
-- [1]33:select count_sec(s1, 'max_interval'='1','standard'='udf','start'='1', 'end'='end') from root.udf.d1
STRICT{
SQLSTATE : 701: Error occurred during inferring UDF data type: 
java.lang.NumberFormatException: For input string: "end"
}
-- [1]35:select count_sec(s1, 'max_interval'='-1', 'standard'='udf') from root.udf.d1
STRICT{
SQLSTATE : 301: Parameter sessionTimeGap(-1) should be equal to or greater than zero.
}

-- [1]36:select count_sec(s1, 'max_interval'='1', 'standard'='udf','start'='0', 'end'='1') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="udf", "start"="0", "end"="1")(FLOAT)      |
总数目：0
}

Elapsed Time: 0.0.3
-- [1]37:select count_sec(s1, 'max_interval'='1','standard'='udf','start'='1', 'end'='0') from root.udf.d1
STRICT{
SQLSTATE : 301: displayWindowEnd(0) < displayWindowBegin(1)
}
-- [1]38:select count_sec(s1, 'max_interval'='1','standard'='udf','start'='1', 'end'='0') from root.udf.d1
STRICT{
SQLSTATE : 301: displayWindowEnd(0) < displayWindowBegin(1)
}

-- [1]40:select count_sec(s1, 'max_interval'='0', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="0", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
2               |0.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |0.0                                                                         |
--------------------------------------------------------------------------------------------
14              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：9
}

Elapsed Time: 0.0.3
-- [1]42:select count_sec(s1, 'max_interval'='1', 'standard'='udf','start'='3', 'end'='1') from root.udf.d1
STRICT{
SQLSTATE : 301: displayWindowEnd(1) < displayWindowBegin(3)
}

-- [1]44:select count_sec(s1, 'max_interval'='1', 'standard'='udf','start'='2', 'end'='2') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="udf", "start"="2", "end"="2")(FLOAT)      |
总数目：0
}

Elapsed Time: 0.0.2

-- [1]48:select count_sec(s1, 'max_interval'='1', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |0.0                                                                         |
--------------------------------------------------------------------------------------------
14              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：8
}

Elapsed Time: 0.0.2

-- [1]49:select count_sec(s1, 'max_interval'='2', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="2", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：7
}

Elapsed Time: 0.0.3

-- [1]50:select count_sec(s1, 'max_interval'='5', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="5", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |5.0                                                                         |
总数目：1
}

Elapsed Time: 0.0.3

-- [1]53:select count_sec(s1, 'max_interval'='3', 'standard'='udf', 'start'='0', 'end'='10') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="3", "standard"="udf", "start"="0", "end"="10")(FLOAT)      |
---------------------------------------------------------------------------------------------------------------------
1               |1.0                                                                                                  |
---------------------------------------------------------------------------------------------------------------------
9               |1.0                                                                                                  |
总数目：2
}

Elapsed Time: 0.0.2

-- [1]54:select count_sec(s1, 'max_interval'='3', 'standard'='udf', 'start'='12', 'end'='24') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="3", "standard"="udf", "start"="12", "end"="24")(FLOAT)      |
----------------------------------------------------------------------------------------------------------------------
12              |1.0                                                                                                   |
----------------------------------------------------------------------------------------------------------------------
18              |1.0                                                                                                   |
总数目：2
}

Elapsed Time: 0.0.2

-- [1]56:select count_sec(s1, 'max_interval'='5', 'standard'='udf2') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="5", "standard"="udf2")(FLOAT)      |
---------------------------------------------------------------------------------------------
1               |0.0                                                                          |
总数目：1
}

Elapsed Time: 0.0.2

-- [1]58:select count_sec(s1, 'max_interval'='1668481541196', 'standard'='udf') from root.udf.d1
STRICT{
Time(TIME)      |count_sec(root.udf.d1.s1, "max_interval"="1668481541196", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------------------
1               |5.0                                                                                     |
总数目：1
}

Elapsed Time: 0.0.2
-- [1]63:CREATE ALIGNED TIMESERIES root.udf.d2 (s1 text, s2 text)
STRICT{
PASS
}
-- [1]64:insert into root.udf.d2 (time, s1, s2) aligned values (1, 'udf', 'trigger'),(2, 'some' , 'old'),(3, null, 'trigger'),(9, 'udf', 'new'),(5, 'woman', 'udf'),(12, 'trigger', null),(14, 'udf', 14),(18, 'udf', 16),(21, 'trigger', 18),(24, 'udf', 20)
STRICT{
0
}

Elapsed Time: 0.0.265

-- [1]66:select * from root.udf.d2
STRICT{
Time(TIME)      |root.udf.d2.s1(TEXT)      |root.udf.d2.s2(TEXT)      |
--------------------------------------------------------------------
1               |udf                       |trigger                   |
--------------------------------------------------------------------
2               |some                      |old                       |
--------------------------------------------------------------------
3               |null                      |trigger                   |
--------------------------------------------------------------------
5               |woman                     |udf                       |
--------------------------------------------------------------------
9               |udf                       |new                       |
--------------------------------------------------------------------
12              |trigger                   |null                      |
--------------------------------------------------------------------
14              |udf                       |14                        |
--------------------------------------------------------------------
18              |udf                       |16                        |
--------------------------------------------------------------------
21              |trigger                   |18                        |
--------------------------------------------------------------------
24              |udf                       |20                        |
总数目：10
}

Elapsed Time: 0.0.4

-- [1]70:select count_sec(s1, 'max_interval'='1', 'standard'='udf') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="1", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |0.0                                                                         |
--------------------------------------------------------------------------------------------
14              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：8
}

Elapsed Time: 0.0.6

-- [1]71:select count_sec(s1, 'max_interval'='2', 'standard'='udf') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="2", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |1.0                                                                         |
--------------------------------------------------------------------------------------------
5               |0.0                                                                         |
--------------------------------------------------------------------------------------------
9               |1.0                                                                         |
--------------------------------------------------------------------------------------------
12              |1.0                                                                         |
--------------------------------------------------------------------------------------------
18              |1.0                                                                         |
--------------------------------------------------------------------------------------------
21              |0.0                                                                         |
--------------------------------------------------------------------------------------------
24              |1.0                                                                         |
总数目：7
}

Elapsed Time: 0.0.4

-- [1]72:select count_sec(s1, 'max_interval'='5', 'standard'='udf') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="5", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------
1               |5.0                                                                         |
总数目：1
}

Elapsed Time: 0.0.3

-- [1]75:select count_sec(s1, 'max_interval'='3', 'standard'='udf', 'start'='0', 'end'='10') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="3", "standard"="udf", "start"="0", "end"="10")(FLOAT)      |
---------------------------------------------------------------------------------------------------------------------
1               |1.0                                                                                                  |
---------------------------------------------------------------------------------------------------------------------
9               |1.0                                                                                                  |
总数目：2
}

Elapsed Time: 0.0.3

-- [1]76:select count_sec(s1, 'max_interval'='3', 'standard'='udf', 'start'='12', 'end'='24') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="3", "standard"="udf", "start"="12", "end"="24")(FLOAT)      |
----------------------------------------------------------------------------------------------------------------------
12              |1.0                                                                                                   |
----------------------------------------------------------------------------------------------------------------------
18              |1.0                                                                                                   |
总数目：2
}

Elapsed Time: 0.0.3

-- [1]78:select count_sec(s1, 'max_interval'='5', 'standard'='udf2') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="5", "standard"="udf2")(FLOAT)      |
---------------------------------------------------------------------------------------------
1               |0.0                                                                          |
总数目：1
}

Elapsed Time: 0.0.3

-- [1]80:select count_sec(s1, 'max_interval'='1668481541196', 'standard'='udf') from root.udf.d2
STRICT{
Time(TIME)      |count_sec(root.udf.d2.s1, "max_interval"="1668481541196", "standard"="udf")(FLOAT)      |
--------------------------------------------------------------------------------------------------------
1               |5.0                                                                                     |
总数目：1
}

Elapsed Time: 0.0.4
-- [1]85:DROP FUNCTION count_SEC
STRICT{
PASS
}
