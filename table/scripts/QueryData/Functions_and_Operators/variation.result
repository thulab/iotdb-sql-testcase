
-- [1]9:create database test_db
STRICT{
PASS
}

-- [1]12:use test_db
STRICT{
PASS
}

-- [1]17:create table table_1 (    	device_id STRING TAG, 	boolean BOOLEAN FIELD, 	text TEXT FIELD, 	string STRING FIELD, 	date DATE FIELD, 	timestamp TIMESTAMP FIELD, 	blob BLOB FIELD, 	int32 INT32 FIELD, 	int64 INT64 FIELD, 	float FLOAT FIELD, 	double DOUBLE FIELD )
STRICT{
PASS
}

-- [1]31:show tables
STRICT{
TableName(TEXT)      |TTL(ms)(TEXT)      |
----------------------------------------
table_1              |INF                |
总数目：1
}
Elapsed Time: 0.0.1

-- [1]34:desc table_1
STRICT{
ColumnName(TEXT)      |DataType(TEXT)      |Category(TEXT)      |
--------------------------------------------------------------
time                  |TIMESTAMP           |TIME                |
--------------------------------------------------------------
device_id             |STRING              |TAG                 |
--------------------------------------------------------------
boolean               |BOOLEAN             |FIELD               |
--------------------------------------------------------------
text                  |TEXT                |FIELD               |
--------------------------------------------------------------
string                |STRING              |FIELD               |
--------------------------------------------------------------
date                  |DATE                |FIELD               |
--------------------------------------------------------------
timestamp             |TIMESTAMP           |FIELD               |
--------------------------------------------------------------
blob                  |BLOB                |FIELD               |
--------------------------------------------------------------
int32                 |INT32               |FIELD               |
--------------------------------------------------------------
int64                 |INT64               |FIELD               |
--------------------------------------------------------------
float                 |FLOAT               |FIELD               |
--------------------------------------------------------------
double                |DOUBLE              |FIELD               |
总数目：12
}
Elapsed Time: 0.0.1

-- [1]40:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 1, 'd1', false, 'text1', 'string1', '2020-01-10', 100000, X'11F8d7', 0, 1000, 1.1, 111.11 )
STRICT{
0
}
Elapsed Time: 0.0.242

-- [1]45:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 2, 'd2', true, 'text2', 'string2', '2020-02-20', 16839200, X'3b', 111, 453, 11.1, 102.2 )
STRICT{
0
}
Elapsed Time: 0.0.50

-- [1]50:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 3, 'd3', true, 'text2', 'string2', '2021-12-20', 116839200000, X'6728', 1, 123, 5.2, 333.3 )
STRICT{
0
}
Elapsed Time: 0.0.5

-- [1]55:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 4, 'd4', false, 'text3', 'string3', '2022-06-11', 86700000, X'4b98', 2, 239, null, 666.66 )
STRICT{
0
}
Elapsed Time: 0.0.9

-- [1]60:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 5, 'd5', false, 'text4', 'string2', '2023-12-15', 1378230000000, X'34', 10, 653, -1.1, 1111.2 )
STRICT{
0
}
Elapsed Time: 0.0.11

-- [1]65:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 6, 'd6', true, 'text3', 'string3', null, 1378230000000, X'00010000', 1, 653, 0.1, 1221.2 )
STRICT{
0
}
Elapsed Time: 0.0.7

-- [1]70:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 7, 'd5', true, 'text4', 'string4', '2023-12-15', 1378230000000, X'FFD8FFE0', 2, null, 555.5, 1111.2 )
STRICT{
0
}
Elapsed Time: 0.0.2

-- [1]75:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 8, 'd3', true, 'text2', 'string5', null, 1378230000000, X'34', 2, 653, 13.13, null )
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]80:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 9, 'd3', true, 'text4', null, '2023-12-15', null, X'49460001', 10, null, 2.1, 155.5 )
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]85:insert into table_1( time, device_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 10, 'd4', false, 'text5', 'string3', '2024-01-15', 18392378000, null, 1, null, -11.1, 11.2 )
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]89:select * from table_1 order by time
STRICT{
time(TIMESTAMP)      |device_id(STRING)      |boolean(BOOLEAN)      |text(TEXT)      |string(STRING)      |date(DATE)      |timestamp(TIMESTAMP)      |blob(BLOB)      |int32(INT32)      |int64(INT64)      |float(FLOAT)      |double(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d1                     |false                 |text1           |string1             |2020-01-10      |1970-01-01T08:01:40.000+08|0x11f8d7        |0                 |1000              |1.1               |111.11              |
01+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d2                     |true                  |text2           |string2             |2020-02-20      |1970-01-01T12:40:39.200+08|0x3b            |111               |453               |11.1              |102.2               |
02+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d3                     |true                  |text2           |string2             |2021-12-20      |1973-09-14T15:20:00.000+08|0x6728          |1                 |123               |5.2               |333.3               |
03+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d4                     |false                 |text3           |string3             |2022-06-11      |1970-01-02T08:05:00.000+08|0x4b98          |2                 |239               |null              |666.66              |
04+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d5                     |false                 |text4           |string2             |2023-12-15      |2013-09-04T01:40:00.000+08|0x34            |10                |653               |-1.1              |1111.2              |
05+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d6                     |true                  |text3           |string3             |null            |2013-09-04T01:40:00.000+08|0x00010000      |1                 |653               |0.1               |1221.2              |
06+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d5                     |true                  |text4           |string4             |2023-12-15      |2013-09-04T01:40:00.000+08|0xffd8ffe0      |2                 |null              |555.5             |1111.2              |
07+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d3                     |true                  |text2           |string5             |null            |2013-09-04T01:40:00.000+08|0x34            |2                 |653               |13.13             |null                |
08+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d3                     |true                  |text4           |null                |2023-12-15      |null                      |0x49460001      |10                |null              |2.1               |155.5               |
09+08:00             |                       |                      |                |                    |                |                          |                |                  |                  |                  |                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|d4                     |false                 |text5           |string3             |2024-01-15      |1970-08-02T04:59:38.000+08|null            |1                 |null              |-11.1             |11.2                |
10+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
总数目：10
}
Elapsed Time: 0.0.4

-- [1]93:select window_index, time, device_id, int32 FROM variation(table_1 PARTITION BY device_id order by time, 'int32', 1.0, false) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |int32(INT32)      |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |0                 |
                         |01+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |111               |
                         |02+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |1                 |
                         |03+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |2                 |
                         |04+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |10                |
                         |05+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |1                 |
                         |06+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |2                 |
                         |08+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |1                 |
                         |10+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |2                 |
                         |07+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |10                |
                         |09+08:00             |                       |                  |
总数目：10
}
Elapsed Time: 0.0.35

-- [1]96:select window_index, time, device_id, int64 FROM variation(table_1 PARTITION BY device_id order by time, 'int64', 2.0, false) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |int64(INT64)      |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |1000              |
                         |01+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |453               |
                         |02+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |123               |
                         |03+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |239               |
                         |04+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |653               |
                         |05+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |653               |
                         |06+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |null              |
                         |07+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |653               |
                         |08+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |null              |
                         |10+08:00             |                       |                  |
---------------------------------------------------------------------------------------
2                        |1970-01-01T08:00:00.0|d3                     |null              |
                         |09+08:00             |                       |                  |
总数目：10
}
Elapsed Time: 0.0.6

-- [1]99:select window_index, time, device_id, float FROM variation(table_1 PARTITION BY device_id order by time, 'float', 1.1, true) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |float(FLOAT)      |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |1.1               |
                         |01+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |11.1              |
                         |02+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |5.2               |
                         |03+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |null              |
                         |04+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |-1.1              |
                         |05+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |0.1               |
                         |06+08:00             |                       |                  |
---------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |-11.1             |
                         |10+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |555.5             |
                         |07+08:00             |                       |                  |
---------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |13.13             |
                         |08+08:00             |                       |                  |
---------------------------------------------------------------------------------------
2                        |1970-01-01T08:00:00.0|d3                     |2.1               |
                         |09+08:00             |                       |                  |
总数目：10
}
Elapsed Time: 0.0.6

-- [1]102:select window_index, time, device_id, double FROM variation(table_1 PARTITION BY device_id order by time, 'double', 100.0, true) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |double(DOUBLE)      |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |111.11              |
                         |01+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |102.2               |
                         |02+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |333.3               |
                         |03+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |666.66              |
                         |04+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |1111.2              |
                         |05+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |1221.2              |
                         |06+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |1111.2              |
                         |07+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |null                |
                         |08+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |155.5               |
                         |09+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |11.2                |
                         |10+08:00             |                       |                    |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]105:select window_index, time, device_id, boolean FROM variation(table_1 PARTITION BY device_id order by time, 'boolean', 0.0, true) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |boolean(BOOLEAN)      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |false                 |
                         |01+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |true                  |
                         |02+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |true                  |
                         |03+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |false                 |
                         |04+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |false                 |
                         |05+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |true                  |
                         |06+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |true                  |
                         |08+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |true                  |
                         |09+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |false                 |
                         |10+08:00             |                       |                      |
-------------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |true                  |
                         |07+08:00             |                       |                      |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]108:select window_index, time, device_id, string FROM variation(table_1 PARTITION BY device_id order by time, 'string', 0.0, true) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |string(STRING)      |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |string1             |
                         |01+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |string2             |
                         |02+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |string2             |
                         |03+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |string3             |
                         |04+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |string2             |
                         |05+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |string3             |
                         |06+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |string3             |
                         |10+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |string4             |
                         |07+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |string5             |
                         |08+08:00             |                       |                    |
-----------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |null                |
                         |09+08:00             |                       |                    |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]111:select window_index, time, device_id, blob FROM variation(table_1 PARTITION BY device_id order by time, 'blob', 0.0, false) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |blob(BLOB)      |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |0x11f8d7        |
                         |01+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |0x3b            |
                         |02+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |0x6728          |
                         |03+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |0x4b98          |
                         |04+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |0x34            |
                         |05+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |0x00010000      |
                         |06+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d5                     |0xffd8ffe0      |
                         |07+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |0x34            |
                         |08+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |null            |
                         |10+08:00             |                       |                |
-------------------------------------------------------------------------------------
2                        |1970-01-01T08:00:00.0|d3                     |0x49460001      |
                         |09+08:00             |                       |                |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]114:select window_index, time, device_id, timestamp FROM variation(DATA=>table_1 PARTITION BY device_id order by time, COL=>'timestamp', ignore_null=>false) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |timestamp(TIMESTAMP)      |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |1970-01-01T08:01:40.000+08|
                         |01+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |1970-01-01T12:40:39.200+08|
                         |02+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |1973-09-14T15:20:00.000+08|
                         |03+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |1970-01-02T08:05:00.000+08|
                         |04+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |2013-09-04T01:40:00.000+08|
                         |05+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |2013-09-04T01:40:00.000+08|
                         |06+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |2013-09-04T01:40:00.000+08|
                         |07+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |2013-09-04T01:40:00.000+08|
                         |08+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |1970-08-02T04:59:38.000+08|
                         |10+08:00             |                       |:00                       |
-----------------------------------------------------------------------------------------------
2                        |1970-01-01T08:00:00.0|d3                     |null                      |
                         |09+08:00             |                       |                          |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]117:select window_index, time, device_id, date FROM variation(table_1 PARTITION BY device_id order by time, 'date', 0.0) order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |date(DATE)      |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |2020-01-10      |
                         |01+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |2020-02-20      |
                         |02+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |2021-12-20      |
                         |03+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |2022-06-11      |
                         |04+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |2023-12-15      |
                         |05+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |null            |
                         |06+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |2023-12-15      |
                         |07+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |null            |
                         |08+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |2023-12-15      |
                         |09+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |2024-01-15      |
                         |10+08:00             |                       |                |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]120:select window_index, time, device_id, text FROM variation(table_1 PARTITION BY device_id order by time, 'text') order by 1,2,3,4
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |text(TEXT)      |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |text1           |
                         |01+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |text2           |
                         |02+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |text2           |
                         |03+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |text3           |
                         |04+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |text4           |
                         |05+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |text3           |
                         |06+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |text4           |
                         |07+08:00             |                       |                |
-------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |text2           |
                         |08+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |text4           |
                         |09+08:00             |                       |                |
-------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d4                     |text5           |
                         |10+08:00             |                       |                |
总数目：10
}
Elapsed Time: 0.0.5

-- [1]126:select * from variation(             DATA => table_1 PARTITION BY device_id order by time,             COL => 'int64',             DELTA => 2.0) order by window_index, time, device_id
STRICT{
window_index(INT64)      |time(TIMESTAMP)      |device_id(STRING)      |boolean(BOOLEAN)      |text(TEXT)      |string(STRING)      |date(DATE)      |timestamp(TIMESTAMP)      |blob(BLOB)      |int32(INT32)      |int64(INT64)      |float(FLOAT)      |double(DOUBLE)      |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d1                     |false                 |text1           |string1             |2020-01-10      |1970-01-01T08:01:40.000+08|0x11f8d7        |0                 |1000              |1.1               |111.11              |
                         |01+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d2                     |true                  |text2           |string2             |2020-02-20      |1970-01-01T12:40:39.200+08|0x3b            |111               |453               |11.1              |102.2               |
                         |02+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d3                     |true                  |text2           |string2             |2021-12-20      |1973-09-14T15:20:00.000+08|0x6728          |1                 |123               |5.2               |333.3               |
                         |03+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |false                 |text3           |string3             |2022-06-11      |1970-01-02T08:05:00.000+08|0x4b98          |2                 |239               |null              |666.66              |
                         |04+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |false                 |text4           |string2             |2023-12-15      |2013-09-04T01:40:00.000+08|0x34            |10                |653               |-1.1              |1111.2              |
                         |05+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d6                     |true                  |text3           |string3             |null            |2013-09-04T01:40:00.000+08|0x00010000      |1                 |653               |0.1               |1221.2              |
                         |06+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d5                     |true                  |text4           |string4             |2023-12-15      |2013-09-04T01:40:00.000+08|0xffd8ffe0      |2                 |null              |555.5             |1111.2              |
                         |07+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
0                        |1970-01-01T08:00:00.0|d4                     |false                 |text5           |string3             |2024-01-15      |1970-08-02T04:59:38.000+08|null            |1                 |null              |-11.1             |11.2                |
                         |10+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |true                  |text2           |string5             |null            |2013-09-04T01:40:00.000+08|0x34            |2                 |653               |13.13             |null                |
                         |08+08:00             |                       |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1                        |1970-01-01T08:00:00.0|d3                     |true                  |text4           |null                |2023-12-15      |null                      |0x49460001      |10                |null              |2.1               |155.5               |
                         |09+08:00             |                       |                      |                |                    |                |                          |                |                  |                  |                  |                    |
总数目：10
}
Elapsed Time: 0.0.6

-- [1]133:select first(time) as window_start, last(time) as window_end, device_id, avg(double) as avg     from variation(             DATA => table_1 PARTITION BY device_id order by time,             COL => 'double',             DELTA => 2.0)        GROUP BY window_index, device_id order by 1,2,3,4
STRICT{
window_start(TIMESTAMP)      |window_end(TIMESTAMP)      |device_id(STRING)      |avg(DOUBLE)      |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.001+08:00|1970-01-01T08:00:00.001+08:|d1                     |111.11           |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.002+08:00|1970-01-01T08:00:00.002+08:|d2                     |102.2            |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.003+08:00|1970-01-01T08:00:00.008+08:|d3                     |333.3            |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.004+08:00|1970-01-01T08:00:00.004+08:|d4                     |666.66           |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.005+08:00|1970-01-01T08:00:00.007+08:|d5                     |1111.2           |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.006+08:00|1970-01-01T08:00:00.006+08:|d6                     |1221.2           |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.009+08:00|1970-01-01T08:00:00.009+08:|d3                     |155.5            |
                             |00                         |                       |                 |
------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.010+08:00|1970-01-01T08:00:00.010+08:|d4                     |11.2             |
                             |00                         |                       |                 |
总数目：8
}
Elapsed Time: 0.0.9

-- [1]138:select window_index, time, device_id, boolean from variation(table_1, 'boolean', 1.0, false)
STRICT{
SQLSTATE : 701: The type of the column [boolean] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]141:select window_index, time, device_id, text from variation(table_1, 'text', 2.0, false)
STRICT{
SQLSTATE : 701: The type of the column [text] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]144:select window_index, time, device_id, string from variation(table_1, 'string', 2.0)
STRICT{
SQLSTATE : 701: The type of the column [string] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]147:select window_index, time, device_id, blob from variation(table_1, 'blob', 2.0)
STRICT{
SQLSTATE : 701: The type of the column [blob] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]150:select window_index, time, device_id, date from variation(table_1, 'date', 2.0)
STRICT{
SQLSTATE : 701: The type of the column [date] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]153:select window_index, time, device_id, timestamp from variation(table_1, 'timestamp', 2.0)
STRICT{
SQLSTATE : 701: The type of the column [timestamp] is not as expected. The column type must be numeric if DELTA is not 0.
}

-- [1]156:select * from variation(table_1, '" + col + "', 1.0, true)
STRICT{
SQLSTATE : 701: Required column [" + col + "] not found in the source table argument.
}
