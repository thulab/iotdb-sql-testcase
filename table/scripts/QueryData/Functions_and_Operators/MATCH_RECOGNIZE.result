
-- [1]9:create database test_db
STRICT{
PASS
}

-- [1]12:use test_db
STRICT{
PASS
}

-- [1]15:create table orders( customer_id TAG, region ATTRIBUTE, order_date DATE, product TEXT, status BOOLEAN, number INT64, totalprice DOUBLE)
STRICT{
PASS
}

-- [1]25:show tables
STRICT{
TableName(TEXT)      |TTL(ms)(TEXT)      |
----------------------------------------
orders               |INF                |
总数目：1
}
Elapsed Time: 0.0.0

-- [1]28:desc orders
STRICT{
ColumnName(TEXT)      |DataType(TEXT)      |Category(TEXT)      |
--------------------------------------------------------------
time                  |TIMESTAMP           |TIME                |
--------------------------------------------------------------
customer_id           |STRING              |TAG                 |
--------------------------------------------------------------
region                |STRING              |ATTRIBUTE           |
--------------------------------------------------------------
order_date            |DATE                |FIELD               |
--------------------------------------------------------------
product               |TEXT                |FIELD               |
--------------------------------------------------------------
status                |BOOLEAN             |FIELD               |
--------------------------------------------------------------
number                |INT64               |FIELD               |
--------------------------------------------------------------
totalprice            |DOUBLE              |FIELD               |
总数目：8
}
Elapsed Time: 0.0.0

-- [1]35:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748736000000, '100', 'beijing', '2025-06-01', 'table', true, 100, 55000.5 					)
STRICT{
0
}
Elapsed Time: 0.0.187

-- [1]41:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748736600000, '100', 'beijing', '2025-06-01', 'table', true, 255, 13200.3 					)
STRICT{
0
}
Elapsed Time: 0.0.4

-- [1]47:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748737200000, '100', 'beijing', '2025-06-01', 'table', true, 888, 12400 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]53:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748737800000, '100', 'beijing', '2025-06-01', 'table', true, 55, 9998.3 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]59:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748739600000, '100', 'beijing', '2025-06-01', 'table', true, 666, 9998.3 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]66:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748822400000, '101', 'shanghai', '2025-06-02', 'door', false, 608, 12350.5 					)
STRICT{
0
}
Elapsed Time: 0.0.50

-- [1]73:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748826000000, '101', 'shanghai', '2025-06-02', 'door', true, 1000, 667849.9 					)
STRICT{
0
}
Elapsed Time: 0.0.2

-- [1]80:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748831400000, '101', 'shanghai', '2025-06-02', 'door', true, 360, 33920.5 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]87:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748835000000, '101', 'shanghai', '2025-06-02', 'door', true, 150, 33920.5 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]93:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748923200000, '100', 'beijing', '2025-06-03', 'table', true, 150, 11230.4 					)
STRICT{
0
}
Elapsed Time: 0.0.1

-- [1]100:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748923300000, '101', 'beijing', '2025-06-04', 'table', true, 50, 55000.00 					)
STRICT{
0
}
Elapsed Time: 0.0.3

-- [1]106:insert into orders( 					time, customer_id, region, order_date, product, status, number, totalprice 					) values 					( 					1748924300000, '102', 'beijing', '2025-06-05', 'table', true, 50, 65000.00 					)
STRICT{
0
}
Elapsed Time: 0.0.7

-- [1]111:select * from orders order by time
STRICT{
time(TIMESTAMP)      |customer_id(STRING)      |region(STRING)      |order_date(DATE)      |product(TEXT)      |status(BOOLEAN)      |number(INT64)      |totalprice(DOUBLE)      |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-01T08:00:00.0|100                      |beijing             |2025-06-01            |table              |true                 |100                |55000.5                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-01T08:10:00.0|100                      |beijing             |2025-06-01            |table              |true                 |255                |13200.3                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-01T08:20:00.0|100                      |beijing             |2025-06-01            |table              |true                 |888                |12400.0                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-01T08:30:00.0|100                      |beijing             |2025-06-01            |table              |true                 |55                 |9998.3                  |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-01T09:00:00.0|100                      |beijing             |2025-06-01            |table              |true                 |666                |9998.3                  |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-02T08:00:00.0|101                      |beijing             |2025-06-02            |door               |false                |608                |12350.5                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-02T09:00:00.0|101                      |beijing             |2025-06-02            |door               |true                 |1000               |667849.9                |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-02T10:30:00.0|101                      |beijing             |2025-06-02            |door               |true                 |360                |33920.5                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-02T11:30:00.0|101                      |beijing             |2025-06-02            |door               |true                 |150                |33920.5                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:00:00.0|100                      |beijing             |2025-06-03            |table              |true                 |150                |11230.4                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:01:40.0|101                      |beijing             |2025-06-04            |table              |true                 |50                 |55000.0                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:18:20.0|102                      |beijing             |2025-06-05            |table              |true                 |50                 |65000.0                 |
00+08:00             |                         |                    |                      |                   |                     |                   |                        |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]125:select * from orders 	MATCH_RECOGNIZE( 		partition by customer_id 		order by number 		measures 			MATCH_NUMBER() AS match, 			CLASSIFIER() AS label 		ALL ROWS PER MATCH 		PATTERN (A+) 		DEFINE 			A AS true 	) AS m order by customer_id,number
STRICT{
customer_id(STRING)      |number(INT64)      |match(INT64)      |label(STRING)      |time(TIMESTAMP)      |region(STRING)      |order_date(DATE)      |product(TEXT)      |status(BOOLEAN)      |totalprice(DOUBLE)      |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |55                 |1                 |A                  |2025-06-01T08:30:00.0|beijing             |2025-06-01            |table              |true                 |9998.3                  |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |100                |1                 |A                  |2025-06-01T08:00:00.0|beijing             |2025-06-01            |table              |true                 |55000.5                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |150                |1                 |A                  |2025-06-03T12:00:00.0|beijing             |2025-06-03            |table              |true                 |11230.4                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |255                |1                 |A                  |2025-06-01T08:10:00.0|beijing             |2025-06-01            |table              |true                 |13200.3                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |666                |1                 |A                  |2025-06-01T09:00:00.0|beijing             |2025-06-01            |table              |true                 |9998.3                  |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
100                      |888                |1                 |A                  |2025-06-01T08:20:00.0|beijing             |2025-06-01            |table              |true                 |12400.0                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                      |50                 |1                 |A                  |2025-06-03T12:01:40.0|beijing             |2025-06-04            |table              |true                 |55000.0                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                      |150                |1                 |A                  |2025-06-02T11:30:00.0|beijing             |2025-06-02            |door               |true                 |33920.5                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                      |360                |1                 |A                  |2025-06-02T10:30:00.0|beijing             |2025-06-02            |door               |true                 |33920.5                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                      |608                |1                 |A                  |2025-06-02T08:00:00.0|beijing             |2025-06-02            |door               |false                |12350.5                 |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
101                      |1000               |1                 |A                  |2025-06-02T09:00:00.0|beijing             |2025-06-02            |door               |true                 |667849.9                |
                         |                   |                  |                   |00+08:00             |                    |                      |                   |                     |                        |
总数目：11
}

Elapsed Time: 0.0.34

-- [1]138:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		measures 			totalprice as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m order by time, price
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.10

-- [1]153:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_LAST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.9

-- [1]165:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_LAST(totalprice, 0) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]177:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_LAST(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|11230.4            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]189:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RUNNING RPR_LAST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.12

-- [1]201:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			FINAL RPR_LAST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]213:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			FINAL RPR_LAST(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|11230.4            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.11

-- [1]227:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_FIRST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.5            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]239:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_FIRST(totalprice, 0) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.5            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]251:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RPR_FIRST(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|12400.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]263:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			RUNNING RPR_FIRST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.5            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]275:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			FINAL RPR_FIRST(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.5            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]287:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			FINAL RPR_FIRST(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|12400.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]301:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]313:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(totalprice, 1) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]325:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|11230.4            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]339:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(totalprice) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]351:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(totalprice, 1) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]363:select m.time, m.price from orders 	MATCH_RECOGNIZE( 	order by time 		measures 			NEXT(totalprice, 2) as price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN(A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]379:select * from orders 	MATCH_RECOGNIZE( 		partition by customer_id 		order by time 		measures  			MATCH_NUMBER() AS match, 			RPR_FIRST(A.time) AS event_start, 			RPR_LAST(A.time) AS event_end, 			RPR_LAST(A.totalprice) AS last_totalprice 	ONE ROW PER MATCH 	PATTERN (A+) 	DEFINE A AS A.totalprice > 10000 	) 	as m ORDER BY customer_id, match, last_totalprice
STRICT{
customer_id(STRING)      |match(INT64)      |event_start(TIMESTAMP)      |event_end(TIMESTAMP)      |last_totalprice(DOUBLE)      |
------------------------------------------------------------------------------------------------------------------------------
100                      |1                 |2025-06-01T08:00:00.000+08:0|2025-06-01T08:20:00.000+08|12400.0                      |
                         |                  |0                           |:00                       |                             |
------------------------------------------------------------------------------------------------------------------------------
100                      |2                 |2025-06-03T12:00:00.000+08:0|2025-06-03T12:00:00.000+08|11230.4                      |
                         |                  |0                           |:00                       |                             |
------------------------------------------------------------------------------------------------------------------------------
101                      |1                 |2025-06-02T08:00:00.000+08:0|2025-06-03T12:01:40.000+08|55000.0                      |
                         |                  |0                           |:00                       |                             |
------------------------------------------------------------------------------------------------------------------------------
102                      |1                 |2025-06-03T12:18:20.000+08:0|2025-06-03T12:18:20.000+08|65000.0                      |
                         |                  |0                           |:00                       |                             |
总数目：4
}
Elapsed Time: 0.0.13

-- [1]397:select * from 	( 	select time, customer_id, region, totalprice from orders 		where region = 'beijing' and time >= 1748736600000 and time < 1748923200000 	) 	MATCH_RECOGNIZE( 		partition by region 		order by time 		measures 			MATCH_NUMBER() AS match, 			RPR_FIRST(A.time) AS event_start, 			RPR_LAST(A.time) AS event_end, 			RPR_LAST(A.totalprice) AS last_totalprice 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE 			A AS A.totalprice > 100000 	) AS m
STRICT{
region(STRING)      |match(INT64)      |event_start(TIMESTAMP)      |event_end(TIMESTAMP)      |last_totalprice(DOUBLE)      |
-------------------------------------------------------------------------------------------------------------------------
beijing             |1                 |2025-06-02T09:00:00.000+08:0|2025-06-02T09:00:00.000+08|667849.9                     |
                    |                  |0                           |:00                       |                             |
总数目：1
}
Elapsed Time: 0.0.11

-- [1]412:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_FIRST(totalprice)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]424:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_FIRST(totalprice), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]436:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_FIRST(totalprice, 2)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|13200.3            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]448:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_FIRST(totalprice, 2), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.5            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]460:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_LAST(totalprice)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.6

-- [1]472:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_LAST(totalprice), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|11230.4            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.14

-- [1]484:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			PREV(RPR_LAST(totalprice, 1)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|55000.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|11230.4            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.12

-- [1]496:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_FIRST(totalprice)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|13200.3            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.11

-- [1]508:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_FIRST(totalprice), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|12400.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.11

-- [1]520:select m.time, m.price from orders 	MATCH_RECOGNIZE( 	order by time 		measures 			NEXT(RPR_FIRST(totalprice, 1)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|12400.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]532:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_FIRST(totalprice, 1), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|9998.3             |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]544:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_LAST(totalprice)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]556:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_LAST(totalprice), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|65000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|null               |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]568:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_LAST(totalprice, 2)) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|13200.3            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|55000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]580:select m.time, m.price from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			NEXT(RPR_LAST(totalprice, 2), 2) AS price 		ALL ROWS PER MATCH 		AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A+) 		DEFINE 			A AS true	 	) AS m
STRICT{
time(TIMESTAMP)      |price(DOUBLE)      |
----------------------------------------
2025-06-01T08:00:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:10:00.0|null               |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:20:00.0|12400.0            |
00+08:00             |                   |
----------------------------------------
2025-06-01T08:30:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-01T09:00:00.0|9998.3             |
00+08:00             |                   |
----------------------------------------
2025-06-02T08:00:00.0|12350.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T09:00:00.0|667849.9           |
00+08:00             |                   |
----------------------------------------
2025-06-02T10:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-02T11:30:00.0|33920.5            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:00:00.0|11230.4            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:01:40.0|55000.0            |
00+08:00             |                   |
----------------------------------------
2025-06-03T12:18:20.0|65000.0            |
00+08:00             |                   |
总数目：12
}
Elapsed Time: 0.0.7

-- [1]595:select m.match, m.num, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		measures 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(number) AS num, 			CLASSIFIER() AS label 		ONE ROW PER MATCH 		PATTERN (B*) 		DEFINE 			B AS B.number < PREV(B.number) 	) AS m order by match, num, label
STRICT{
match(INT64)      |num(INT64)      |label(STRING)      |
-----------------------------------------------------
1                 |null            |null               |
-----------------------------------------------------
2                 |null            |null               |
-----------------------------------------------------
3                 |null            |null               |
-----------------------------------------------------
4                 |55              |B                  |
-----------------------------------------------------
5                 |null            |null               |
-----------------------------------------------------
6                 |608             |B                  |
-----------------------------------------------------
7                 |null            |null               |
-----------------------------------------------------
8                 |150             |B                  |
-----------------------------------------------------
9                 |null            |null               |
-----------------------------------------------------
10                |50              |B                  |
-----------------------------------------------------
11                |null            |null               |
总数目：11
}
Elapsed Time: 0.0.8

-- [1]618:select * from orders 	MATCH_RECOGNIZE( 	order by time,customer_id 	measures 		MATCH_NUMBER() AS match, 		RUNNING RPR_LAST(totalprice) AS price, 		CLASSIFIER() as label 	ALL ROWS PER MATCH 	PATTERN (A B+ C+ D?) 	SUBSET U = (C, D) 	DEFINE 		B AS B.totalprice < PREV (B.totalprice), 		C AS C.totalprice > PREV (C.totalprice), 		D as false 	) 	as m order by time, customer_id, match, price
STRICT{
time(TIMESTAMP)      |customer_id(STRING)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |region(STRING)      |order_date(DATE)      |product(TEXT)      |status(BOOLEAN)      |number(INT64)      |totalprice(DOUBLE)      |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-02T11:30:00.0|101                      |1                 |33920.5            |A                  |beijing             |2025-06-02            |door               |true                 |150                |33920.5                 |
00+08:00             |                         |                  |                   |                   |                    |                      |                   |                     |                   |                        |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:00:00.0|100                      |1                 |11230.4            |B                  |beijing             |2025-06-03            |table              |true                 |150                |11230.4                 |
00+08:00             |                         |                  |                   |                   |                    |                      |                   |                     |                   |                        |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:01:40.0|101                      |1                 |55000.0            |C                  |beijing             |2025-06-04            |table              |true                 |50                 |55000.0                 |
00+08:00             |                         |                  |                   |                   |                    |                      |                   |                     |                   |                        |
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:18:20.0|102                      |1                 |65000.0            |C                  |beijing             |2025-06-05            |table              |true                 |50                 |65000.0                 |
00+08:00             |                         |                  |                   |                   |                    |                      |                   |                     |                   |                        |
总数目：4
}
Elapsed Time: 0.0.11

-- [1]641:select m.time, m.match, m.price, m.label, m.prev_label, m.next_label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES  			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label,             PREV(CLASSIFIER()) AS prev_label,             NEXT(CLASSIFIER()) AS next_label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN ((L | H) A)  		DEFINE 			A AS A.totalprice = 55000, 			L AS L.totalprice < 55000, 			H AS H.totalprice > 55000     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |prev_label(STRING)      |next_label(STRING)      |
-----------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:00:00.0|1                 |11230.4            |L                  |null                    |A                       |
00+08:00             |                  |                   |                   |                        |                        |
-----------------------------------------------------------------------------------------------------------------------------
2025-06-03T12:01:40.0|1                 |55000.0            |A                  |L                       |null                    |
00+08:00             |                  |                   |                   |                        |                        |
总数目：2
}
Elapsed Time: 0.0.10

-- [1]656:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time  		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (^A) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |55000.5            |A                  |
00+08:00             |                  |                   |                   |
总数目：1
}
Elapsed Time: 0.0.8

-- [1]671:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A^) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
总数目：0
}
Elapsed Time: 0.0.10

-- [1]684:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (^A^) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
总数目：0
}
Elapsed Time: 0.0.8

-- [1]698:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A$) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|1                 |65000.0            |A                  |
00+08:00             |                  |                   |                   |
总数目：1
}
Elapsed Time: 0.0.8

-- [1]713:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN ($A) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
总数目：0
}
Elapsed Time: 0.0.7

-- [1]726:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN ($A$) 		DEFINE A AS true     ) AS m
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
总数目：0
}
Elapsed Time: 0.0.7

-- [1]743:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (A B C) 		DEFINE 			B AS B.totalprice < PREV (B.totalprice), 			C AS C.totalprice = PREV (C.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|1                 |9998.3             |C                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|2                 |667849.9           |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|2                 |33920.5            |C                  |
00+08:00             |                  |                   |                   |
总数目：6
}
Elapsed Time: 0.0.9

-- [1]761:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (B | C | A) 		DEFINE 			B AS B.totalprice < PREV (B.totalprice), 			C AS C.totalprice <= PREV (C.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |55000.5            |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |9998.3             |C                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |12350.5            |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |667849.9           |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |33920.5            |C                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |11230.4            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |55000.0            |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |65000.0            |A                  |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.9

-- [1]779:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (PERMUTE(B, C)) 		DEFINE 			B AS B.totalprice < PREV (B.totalprice), 			C AS C.totalprice < PREV (C.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |C                  |
00+08:00             |                  |                   |                   |
总数目：2
}
Elapsed Time: 0.0.11

-- [1]796:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time 		MEASURES 			MATCH_NUMBER() AS match,             RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW 		PATTERN (((A) (B (C)))) 		DEFINE 			B AS B.totalprice < PREV (B.totalprice), 			C AS C.totalprice = PREV (C.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|1                 |9998.3             |C                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|2                 |667849.9           |A                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|2                 |33920.5            |C                  |
00+08:00             |                  |                   |                   |
总数目：6
}
Elapsed Time: 0.0.9

-- [1]812:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B*)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|5                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]828:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B*?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.8

-- [1]844:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B+)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|2                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]860:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B+?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]876:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price, label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |11230.4            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.10

-- [1]892:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 	order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B??)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.10

-- [1]908:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{,})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price,label
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|5                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.10

-- [1]924:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{,}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.9

-- [1]940:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1,})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|2                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]956:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1,}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]972:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{2,})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|1                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|2                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|2                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]988:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{2,}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|1                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|2                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|3                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|3                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
总数目：6
}
Elapsed Time: 0.0.9

-- [1]1004:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{,1})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |11230.4            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.10

-- [1]1020:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{,1}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:00:00.0|1                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|2                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|3                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|4                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|5                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T08:00:00.0|6                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T09:00:00.0|7                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|8                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|9                 |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|10                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:01:40.0|11                |null               |null               |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:18:20.0|12                |null               |null               |
00+08:00             |                  |                   |                   |
总数目：12
}
Elapsed Time: 0.0.9

-- [1]1036:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1,1})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]1052:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1,1}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]1068:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1})         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.9

-- [1]1084:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE( 		order by time         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
time(TIMESTAMP)      |match(INT64)      |price(DOUBLE)      |label(STRING)      |
-----------------------------------------------------------------------------
2025-06-01T08:10:00.0|1                 |13200.3            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:20:00.0|2                 |12400.0            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T08:30:00.0|3                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-01T09:00:00.0|4                 |9998.3             |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T10:30:00.0|5                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-02T11:30:00.0|6                 |33920.5            |B                  |
00+08:00             |                  |                   |                   |
-----------------------------------------------------------------------------
2025-06-03T12:00:00.0|7                 |11230.4            |B                  |
00+08:00             |                  |                   |                   |
总数目：7
}
Elapsed Time: 0.0.8

-- [1]1100:SELECT m.match, m.count_total from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |count_total(INT64)      |
------------------------------------------
1                 |12                      |
总数目：1
}
Elapsed Time: 0.0.13

-- [1]1111:SELECT m.match, m.sum_totalprice from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			SUM(totalprice) AS sum_totalprice 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |sum_totalprice(DOUBLE)      |
----------------------------------------------
1                 |979869.2000000001           |
总数目：1
}
Elapsed Time: 0.0.7

-- [1]1122:SELECT m.match, m.avg_totalprice from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			AVG(totalprice) AS avg_totalprice 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |avg_totalprice(DOUBLE)      |
----------------------------------------------
1                 |81655.76666666668           |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]1133:SELECT m.match, m.max_totalprice from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			MAX(totalprice) AS max_totalprice 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |max_totalprice(DOUBLE)      |
----------------------------------------------
1                 |667849.9                    |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]1144:SELECT m.match, m.min_totalprice from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			MIN(totalprice) AS min_totalprice 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |min_totalprice(DOUBLE)      |
----------------------------------------------
1                 |9998.3                      |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]1155:SELECT m.match, m.max_by from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			MAX_BY(number, totalprice) AS max_by 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |max_by(INT64)      |
-------------------------------------
1                 |1000               |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]1166:SELECT m.match, m.min_by from orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			MIN_BY(number, totalprice) AS min_by 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |min_by(INT64)      |
-------------------------------------
1                 |55                 |
总数目：1
}
Elapsed Time: 0.0.6

-- [1]1181:SELECT m.match, m.customer_id, m.count_total from orders 	MATCH_RECOGNIZE ( 		PARTITION BY customer_id 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m order by m.match, m.customer_id, m.count_total
STRICT{
match(INT64)      |customer_id(STRING)      |count_total(INT64)      |
-------------------------------------------------------------------
1                 |100                      |6                       |
-------------------------------------------------------------------
1                 |101                      |5                       |
-------------------------------------------------------------------
1                 |102                      |1                       |
总数目：3
}
Elapsed Time: 0.0.8

-- [1]1195:SELECT m.match, m.customer_id, m.count_total from orders 	MATCH_RECOGNIZE ( 		PARTITION BY customer_id 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS A.number < 500 	) AS m order by m.match, m.customer_id, m.count_total
STRICT{
match(INT64)      |customer_id(STRING)      |count_total(INT64)      |
-------------------------------------------------------------------
1                 |100                      |2                       |
-------------------------------------------------------------------
1                 |101                      |3                       |
-------------------------------------------------------------------
1                 |102                      |1                       |
-------------------------------------------------------------------
2                 |100                      |1                       |
-------------------------------------------------------------------
3                 |100                      |1                       |
总数目：5
}
Elapsed Time: 0.0.8

-- [1]1209:SELECT m.match, m.customer_id, m.count_total from orders 	MATCH_RECOGNIZE ( 		PARTITION BY customer_id 		ORDER BY totalprice 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ALL ROWS PER MATCH 		PATTERN (A+) 		DEFINE A AS A.number < 500 	) AS m order by m.match, m.customer_id, m.count_total
STRICT{
match(INT64)      |customer_id(STRING)      |count_total(INT64)      |
-------------------------------------------------------------------
1                 |100                      |1                       |
-------------------------------------------------------------------
1                 |101                      |1                       |
-------------------------------------------------------------------
1                 |101                      |2                       |
-------------------------------------------------------------------
1                 |101                      |3                       |
-------------------------------------------------------------------
2                 |100                      |1                       |
-------------------------------------------------------------------
3                 |100                      |1                       |
-------------------------------------------------------------------
3                 |100                      |2                       |
总数目：7
}

Elapsed Time: 0.0.9

-- [1]1223:SELECT m.match, m.customer_id, m.count_total from orders 	MATCH_RECOGNIZE ( 		PARTITION BY customer_id 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS A.number > 88888888 	) AS m
STRICT{
match(INT64)      |customer_id(STRING)      |count_total(INT64)      |
总数目：0
}
Elapsed Time: 0.0.8

-- [1]1239:SELECT m.match, m.count_total FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+ B) 		SUBSET U = (A, B) 		DEFINE  			A AS A.product = 'door', 			B AS B.customer_id = '101' 	) AS m
STRICT{
match(INT64)      |count_total(INT64)      |
------------------------------------------
1                 |4                       |
总数目：1
}

Elapsed Time: 0.0.11

-- [1]1255:SELECT m.match, m.count_total FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A+ B) 		SUBSET U = (A, B) 		DEFINE  			A AS A.number < 666, 			B AS B.totalprice > 10000 	) AS m
STRICT{
match(INT64)      |count_total(INT64)      |
------------------------------------------
1                 |3                       |
------------------------------------------
2                 |2                       |
------------------------------------------
3                 |5                       |
总数目：3
}

Elapsed Time: 0.0.9
-- [1]1269:SELECT m.match, m.count_total FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			COUNT(totalprice) AS count_total 		ONE ROW PER MATCH 		PATTERN (A*) 		DEFINE  			A AS A.product = true 	) AS m
STRICT{
SQLSTATE : 701: Cannot apply operator: TEXT = BOOLEAN
}

-- [1]1283:SELECT m.match, m.count_total, m.invalid_measure FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			AVG(PREV(totalprice)) AS invalid_measure 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
SQLSTATE : 701: Cannot nest prev pattern navigation function inside avg function
}

-- [1]1297:SELECT m.match, m.count_total, m.invalid_measure FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			PREV(AVG(totalprice)) AS invalid_measure 		ONE ROW PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
SQLSTATE : 701: Cannot nest avg aggregate function inside prev function
}

-- [1]1311:SELECT m.match, m.running_count, m.final_count FROM orders 	MATCH_RECOGNIZE ( 		ORDER BY time 		MEASURES 			MATCH_NUMBER() AS match, 			RUNNING COUNT(number) AS running_count, 			FINAL COUNT(number) AS final_count 		ALL ROWS PER MATCH 		PATTERN (A+) 		DEFINE A AS true 	) AS m
STRICT{
match(INT64)      |running_count(INT64)      |final_count(INT64)      |
--------------------------------------------------------------------
1                 |1                         |12                      |
--------------------------------------------------------------------
1                 |2                         |12                      |
--------------------------------------------------------------------
1                 |3                         |12                      |
--------------------------------------------------------------------
1                 |4                         |12                      |
--------------------------------------------------------------------
1                 |5                         |12                      |
--------------------------------------------------------------------
1                 |6                         |12                      |
--------------------------------------------------------------------
1                 |7                         |12                      |
--------------------------------------------------------------------
1                 |8                         |12                      |
--------------------------------------------------------------------
1                 |9                         |12                      |
--------------------------------------------------------------------
1                 |10                        |12                      |
--------------------------------------------------------------------
1                 |11                        |12                      |
--------------------------------------------------------------------
1                 |12                        |12                      |
总数目：12
}

Elapsed Time: 0.0.10

-- [1]1327:select * from orders  	MATCH_RECOGNIZE( 		partition by region 		order by order_date 		measures               A.totalprice AS starting_price,               LAST(B.totalprice) AS bottom_price,               LAST(D.totalprice) AS top_price      ONE ROW PER MATCH      AFTER MATCH SKIP PAST LAST ROW      PATTERN (A B+ C+ D+)      DEFINE               B AS totalprice < PREV(totalprice),               C AS totalprice > PREV(totalprice) AND totalprice <= A.totalprice,               D AS totalprice > PREV(totalprice) )
STRICT{
region(STRING)      |starting_price(DOUBLE)      |bottom_price(DOUBLE)      |top_price(DOUBLE)      |
总数目：0
}

Elapsed Time: 0.0.12

###### COMPARE RESULT : FAIL ######

-- [1]1349:select m.time, m.region, m.product, m.lower_or_higher, m.label from orders 	MATCH_RECOGNIZE ( 		order by time 		measures 			MATCH_NUMBER() AS match, 			RUNNING FIRST(totalprice) AS price, 			CLASSIFIER(U) AS lower_or_higher, 			CLASSIFIER(W) AS label 		ALL ROWS PER MATCH 		PATTERN ((L | H) A) 		SUBSET  			U = (L, H), 			W = (A, L, H) 		DEFINE  			A AS A.number = 666, 			L AS L.number < 666, 			H AS H.number > 666 	) AS m
STRICT{
time(TIMESTAMP)      |region(STRING)      |product(TEXT)      |lower_or_higher(STRING)      |label(STRING)      |
------------------------------------------------------------------------------------------------------------
2025-06-01T08:30:00.0|beijing             |table              |L                            |L                  |
00+08:00             |                    |                   |                             |                   |
------------------------------------------------------------------------------------------------------------
2025-06-01T09:00:00.0|beijing             |table              |L                            |A                  |
00+08:00             |                    |                   |                             |                   |
总数目：2
}

Elapsed Time: 0.0.11
-- [1]1365:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE(         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{0,0}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
SQLSTATE : 701: Pattern quantifier upper bound must be greater than or equal to 1
}

-- [1]1380:select m.time, m.match, m.price, m.label from orders 	MATCH_RECOGNIZE(         MEASURES 			MATCH_NUMBER() AS match, 			RUNNING RPR_LAST(totalprice) AS price,             CLASSIFIER() AS label         ALL ROWS PER MATCH         AFTER MATCH SKIP PAST LAST ROW         PATTERN (B{1.1,1}?)         DEFINE 			B AS B.totalprice <= PREV(B.totalprice)     ) AS m order by time, match, price
STRICT{
SQLSTATE : 700: line 1:278: mismatched input '1.1'. Expecting: ',', <integer>
}
