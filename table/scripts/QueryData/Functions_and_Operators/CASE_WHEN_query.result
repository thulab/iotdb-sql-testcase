-- [1]9:create database test_db
STRICT{
PASS
}
-- [1]12:use test_db
STRICT{
PASS
}
-- [1]16:create table table1 (   time TIMESTAMP TIME,   region STRING TAG,   device_id STRING TAG,   model_id STRING ATTRIBUTE,   maintenance STRING ATTRIBUTE,   temperature FLOAT FIELD,   humidity FLOAT FIELD,   status Boolean FIELD,   arrival_time TIMESTAMP FIELD )
STRICT{
PASS
}

-- [1]28:show tables
STRICT{
TableName(TEXT)      |TTL(ms)(TEXT)      |
----------------------------------------
table1               |INF                |
总数目：1
}

Elapsed Time: 0.0.1

-- [1]31:desc table1
STRICT{
ColumnName(TEXT)      |DataType(TEXT)      |Category(TEXT)      |
--------------------------------------------------------------
time                  |TIMESTAMP           |TIME                |
--------------------------------------------------------------
region                |STRING              |TAG                 |
--------------------------------------------------------------
device_id             |STRING              |TAG                 |
--------------------------------------------------------------
model_id              |STRING              |ATTRIBUTE           |
--------------------------------------------------------------
maintenance           |STRING              |ATTRIBUTE           |
--------------------------------------------------------------
temperature           |FLOAT               |FIELD               |
--------------------------------------------------------------
humidity              |FLOAT               |FIELD               |
--------------------------------------------------------------
status                |BOOLEAN             |FIELD               |
--------------------------------------------------------------
arrival_time          |TIMESTAMP           |FIELD               |
总数目：9
}

Elapsed Time: 0.0.0
-- [1]52:INSERT INTO table1(time, region, device_id, model_id, maintenance, temperature, humidity, status, arrival_time) VALUES    (1000, '北京', 'd1', 'A', '190', 90.0, 35.1, true, 2024-11-26 13:37:34),   (2000, '北京', 'd1', 'A', '190', 90.0, 35.1, true, 2024-11-01 13:38:25),   (3000, '北京', 'd2', 'B', '181', NULL, 35.1, true, 2024-10-27 16:37:01),   (4000, '北京', 'd2', 'B', '181', 85.0, NULL, NULL, 2024-11-27 16:37:03),   (6000, '北京', 'd2', 'B', '181', 85.0, NULL, NULL, 2024-11-29 16:00:04),   (7000, '北京', 'd3', 'C', '155', NULL, 35.2, false, Null),   (8000, '北京', 'd3', 'C', '155', NULL, Null, false, Null),   (9000, '北京', 'd3', 'C', '155', NULL, Null, false, 2024-10-31 16:37:08),   (10000, '上海', 'd4', 'D', '94', 85.0, Null, NULL, 2024-11-28 08:00:09),   (11000, '上海', 'd4', 'D', '94', NULL, 40.9, true, NULL),   (12000, '上海', 'd4', 'D', '94', 85.0, 35.2, NULL, 2024-12-01 10:00:11),   (13000, '上海', 'd5', 'E', '90', 88.0, 45.1, true, 2024-11-30 11:00:12),   (14000, '上海', 'd5', 'E', '362', 85.0, NULL, NULL, 2024-11-29 10:00:13),   (15000, '上海', 'd5', 'E', '362', NULL, 45.1, true, NULL),   (16000, '上海', 'd5', 'E', '362', 90.0, 35.4, true, 2024-11-20 18:30:15),   (17000, '上海', 'd5', 'F', '362', 90.0, 35.2, true, NULL),   (18000, '上海', 'd5', 'F', '362', 90.0, 34.8, true, 2024-11-30 23:30:17)
STRICT{
0
}

Elapsed Time: 0.2.34

-- [1]54:select * from table1 order by time
STRICT{
time(TIMESTAMP)      |region(STRING)      |device_id(STRING)      |model_id(STRING)      |maintenance(STRING)      |temperature(FLOAT)      |humidity(FLOAT)      |status(BOOLEAN)      |arrival_time(TIMESTAMP)      |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:01.0|北京                  |d1                     |A                     |190                      |90.0                    |35.1                 |true                 |2024-11-26T13:37:34.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:02.0|北京                  |d1                     |A                     |190                      |90.0                    |35.1                 |true                 |2024-11-01T13:38:25.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:03.0|北京                  |d2                     |B                     |181                      |null                    |35.1                 |true                 |2024-10-27T16:37:01.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:04.0|北京                  |d2                     |B                     |181                      |85.0                    |null                 |null                 |2024-11-27T16:37:03.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:06.0|北京                  |d2                     |B                     |181                      |85.0                    |null                 |null                 |2024-11-29T16:00:04.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:07.0|北京                  |d3                     |C                     |155                      |null                    |35.2                 |false                |null                         |
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:08.0|北京                  |d3                     |C                     |155                      |null                    |null                 |false                |null                         |
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:09.0|北京                  |d3                     |C                     |155                      |null                    |null                 |false                |2024-10-31T16:37:08.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:10.0|上海                  |d4                     |D                     |94                       |85.0                    |null                 |null                 |2024-11-28T08:00:09.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:11.0|上海                  |d4                     |D                     |94                       |null                    |40.9                 |true                 |null                         |
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:12.0|上海                  |d4                     |D                     |94                       |85.0                    |35.2                 |null                 |2024-12-01T10:00:11.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:13.0|上海                  |d5                     |F                     |362                      |88.0                    |45.1                 |true                 |2024-11-30T11:00:12.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:14.0|上海                  |d5                     |F                     |362                      |85.0                    |null                 |null                 |2024-11-29T10:00:13.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:15.0|上海                  |d5                     |F                     |362                      |null                    |45.1                 |true                 |null                         |
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:16.0|上海                  |d5                     |F                     |362                      |90.0                    |35.4                 |true                 |2024-11-20T18:30:15.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:17.0|上海                  |d5                     |F                     |362                      |90.0                    |35.2                 |true                 |null                         |
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:18.0|上海                  |d5                     |F                     |362                      |90.0                    |34.8                 |true                 |2024-11-30T23:30:17.000+08:00|
00+08:00             |                    |                       |                      |                         |                        |                     |                     |                             |
总数目：17
}

Elapsed Time: 0.0.4

-- [1]63:select      device_id,     temperature,     CASE          WHEN temperature IS NULL THEN '未知'         WHEN temperature > 85 THEN '高'         WHEN temperature BETWEEN 70 AND 85 THEN '中'         ELSE '低'     END AS temperature_category from      table1 order by 1,2,3
STRICT{
device_id(STRING)      |temperature(FLOAT)      |temperature_category(STRING)      |
---------------------------------------------------------------------------------
d1                     |90.0                    |高                                 |
---------------------------------------------------------------------------------
d1                     |90.0                    |高                                 |
---------------------------------------------------------------------------------
d2                     |85.0                    |中                                 |
---------------------------------------------------------------------------------
d2                     |85.0                    |中                                 |
---------------------------------------------------------------------------------
d2                     |null                    |未知                                |
---------------------------------------------------------------------------------
d3                     |null                    |未知                                |
---------------------------------------------------------------------------------
d3                     |null                    |未知                                |
---------------------------------------------------------------------------------
d3                     |null                    |未知                                |
---------------------------------------------------------------------------------
d4                     |85.0                    |中                                 |
---------------------------------------------------------------------------------
d4                     |85.0                    |中                                 |
---------------------------------------------------------------------------------
d4                     |null                    |未知                                |
---------------------------------------------------------------------------------
d5                     |85.0                    |中                                 |
---------------------------------------------------------------------------------
d5                     |88.0                    |高                                 |
---------------------------------------------------------------------------------
d5                     |90.0                    |高                                 |
---------------------------------------------------------------------------------
d5                     |90.0                    |高                                 |
---------------------------------------------------------------------------------
d5                     |90.0                    |高                                 |
---------------------------------------------------------------------------------
d5                     |null                    |未知                                |
总数目：17
}

Elapsed Time: 0.0.6

-- [1]76:select      device_id,     status,     CASE          WHEN status IS NULL THEN '状态未知'         WHEN status = true THEN '正常'         ELSE '故障'     END AS status_description from     table1 order by 1,2,3
STRICT{
device_id(STRING)      |status(BOOLEAN)      |status_description(STRING)      |
----------------------------------------------------------------------------
d1                     |true                 |正常                              |
----------------------------------------------------------------------------
d1                     |true                 |正常                              |
----------------------------------------------------------------------------
d2                     |true                 |正常                              |
----------------------------------------------------------------------------
d2                     |null                 |状态未知                            |
----------------------------------------------------------------------------
d2                     |null                 |状态未知                            |
----------------------------------------------------------------------------
d3                     |false                |故障                              |
----------------------------------------------------------------------------
d3                     |false                |故障                              |
----------------------------------------------------------------------------
d3                     |false                |故障                              |
----------------------------------------------------------------------------
d4                     |true                 |正常                              |
----------------------------------------------------------------------------
d4                     |null                 |状态未知                            |
----------------------------------------------------------------------------
d4                     |null                 |状态未知                            |
----------------------------------------------------------------------------
d5                     |true                 |正常                              |
----------------------------------------------------------------------------
d5                     |true                 |正常                              |
----------------------------------------------------------------------------
d5                     |true                 |正常                              |
----------------------------------------------------------------------------
d5                     |true                 |正常                              |
----------------------------------------------------------------------------
d5                     |true                 |正常                              |
----------------------------------------------------------------------------
d5                     |null                 |状态未知                            |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]89:select      device_id,     maintenance,     CASE          WHEN maintenance < '100' THEN '需要维护'         WHEN maintenance BETWEEN '100' AND '200' THEN '维护良好'         ELSE '维护完好'     END AS maintenance_status from      table1 order by 1,2,3
STRICT{
device_id(STRING)      |maintenance(STRING)      |maintenance_status(STRING)      |
--------------------------------------------------------------------------------
d1                     |190                      |维护良好                            |
--------------------------------------------------------------------------------
d1                     |190                      |维护良好                            |
--------------------------------------------------------------------------------
d2                     |181                      |维护良好                            |
--------------------------------------------------------------------------------
d2                     |181                      |维护良好                            |
--------------------------------------------------------------------------------
d2                     |181                      |维护良好                            |
--------------------------------------------------------------------------------
d3                     |155                      |维护良好                            |
--------------------------------------------------------------------------------
d3                     |155                      |维护良好                            |
--------------------------------------------------------------------------------
d3                     |155                      |维护良好                            |
--------------------------------------------------------------------------------
d4                     |94                       |维护完好                            |
--------------------------------------------------------------------------------
d4                     |94                       |维护完好                            |
--------------------------------------------------------------------------------
d4                     |94                       |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
--------------------------------------------------------------------------------
d5                     |362                      |维护完好                            |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]103:select device_id, arrival_time,        CASE             WHEN arrival_time < 2024-11-01T00:00:00 THEN 'Before November 2024'            WHEN arrival_time >= 2024-11-01 AND arrival_time < 2024-12-01 THEN 'The November of 2024' 		   WHEN arrival_time >= 2024-12-01 THEN 'AFTER November 2024'            ELSE 'Unknown'        END AS time_category from  	table1 order by 1,2,3
STRICT{
device_id(STRING)      |arrival_time(TIMESTAMP)      |time_category(STRING)      |
-------------------------------------------------------------------------------
d1                     |2024-11-01T13:38:25.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d1                     |2024-11-26T13:37:34.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d2                     |2024-10-27T16:37:01.000+08:00|Before November 2024       |
-------------------------------------------------------------------------------
d2                     |2024-11-27T16:37:03.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d2                     |2024-11-29T16:00:04.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d3                     |2024-10-31T16:37:08.000+08:00|Before November 2024       |
-------------------------------------------------------------------------------
d3                     |null                         |Unknown                    |
-------------------------------------------------------------------------------
d3                     |null                         |Unknown                    |
-------------------------------------------------------------------------------
d4                     |2024-11-28T08:00:09.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d4                     |2024-12-01T10:00:11.000+08:00|AFTER November 2024        |
-------------------------------------------------------------------------------
d4                     |null                         |Unknown                    |
-------------------------------------------------------------------------------
d5                     |2024-11-20T18:30:15.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d5                     |2024-11-29T10:00:13.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d5                     |2024-11-30T11:00:12.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d5                     |2024-11-30T23:30:17.000+08:00|The November of 2024       |
-------------------------------------------------------------------------------
d5                     |null                         |Unknown                    |
-------------------------------------------------------------------------------
d5                     |null                         |Unknown                    |
总数目：17
}

Elapsed Time: 0.0.7

-- [1]115:select      device_id,     humidity,     CASE          WHEN humidity IS NULL THEN '未知'         WHEN humidity > 40 THEN '高湿'         WHEN humidity BETWEEN 30 AND 40 THEN '适中湿度'         ELSE '干燥'     END AS humidity_category from      table1 order by 1,2,3
STRICT{
device_id(STRING)      |humidity(FLOAT)      |humidity_category(STRING)      |
---------------------------------------------------------------------------
d1                     |35.1                 |适中湿度                           |
---------------------------------------------------------------------------
d1                     |35.1                 |适中湿度                           |
---------------------------------------------------------------------------
d2                     |35.1                 |适中湿度                           |
---------------------------------------------------------------------------
d2                     |null                 |未知                             |
---------------------------------------------------------------------------
d2                     |null                 |未知                             |
---------------------------------------------------------------------------
d3                     |35.2                 |适中湿度                           |
---------------------------------------------------------------------------
d3                     |null                 |未知                             |
---------------------------------------------------------------------------
d3                     |null                 |未知                             |
---------------------------------------------------------------------------
d4                     |35.2                 |适中湿度                           |
---------------------------------------------------------------------------
d4                     |40.9                 |高湿                             |
---------------------------------------------------------------------------
d4                     |null                 |未知                             |
---------------------------------------------------------------------------
d5                     |34.8                 |适中湿度                           |
---------------------------------------------------------------------------
d5                     |35.2                 |适中湿度                           |
---------------------------------------------------------------------------
d5                     |35.4                 |适中湿度                           |
---------------------------------------------------------------------------
d5                     |45.1                 |高湿                             |
---------------------------------------------------------------------------
d5                     |45.1                 |高湿                             |
---------------------------------------------------------------------------
d5                     |null                 |未知                             |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]138:select      device_id,     CASE         WHEN temperature IS NULL OR humidity IS NULL THEN '数据不完整'         WHEN temperature > 85 AND humidity > 40 THEN '高温高湿'         WHEN temperature > 85 AND humidity <= 40 THEN '高温低湿'         WHEN temperature <= 85 AND humidity > 40 THEN '低温高湿'         ELSE '低温低湿'     END AS climate_condition,     COUNT(*) AS record_count from table1 group by     device_id,     CASE         WHEN temperature IS NULL OR humidity IS NULL THEN '数据不完整'         WHEN temperature > 85 AND humidity > 40 THEN '高温高湿'         WHEN temperature > 85 AND humidity <= 40 THEN '高温低湿'         WHEN temperature <= 85 AND humidity > 40 THEN '低温高湿'         ELSE '低温低湿'     END order by 1,2,3
STRICT{
device_id(STRING)      |climate_condition(STRING)      |record_count(INT64)      |
-------------------------------------------------------------------------------
d1                     |高温低湿                           |2                        |
-------------------------------------------------------------------------------
d2                     |数据不完整                          |3                        |
-------------------------------------------------------------------------------
d3                     |数据不完整                          |3                        |
-------------------------------------------------------------------------------
d4                     |低温低湿                           |1                        |
-------------------------------------------------------------------------------
d4                     |数据不完整                          |2                        |
-------------------------------------------------------------------------------
d5                     |数据不完整                          |2                        |
-------------------------------------------------------------------------------
d5                     |高温低湿                           |3                        |
-------------------------------------------------------------------------------
d5                     |高温高湿                           |1                        |
总数目：8
}

Elapsed Time: 0.0.8

-- [1]152:select      device_id,     maintenance,     status,     CASE          WHEN maintenance < '100' AND status = false THEN '故障，需立即维护'         WHEN maintenance < '100' THEN '需维护'         WHEN status = false THEN '故障'         ELSE '正常'     END AS report from      table1 order by 1,2,3,4
STRICT{
device_id(STRING)      |maintenance(STRING)      |status(BOOLEAN)      |report(STRING)      |
-----------------------------------------------------------------------------------------
d1                     |190                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d1                     |190                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d2                     |181                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d2                     |181                      |null                 |正常                  |
-----------------------------------------------------------------------------------------
d2                     |181                      |null                 |正常                  |
-----------------------------------------------------------------------------------------
d3                     |155                      |false                |故障                  |
-----------------------------------------------------------------------------------------
d3                     |155                      |false                |故障                  |
-----------------------------------------------------------------------------------------
d3                     |155                      |false                |故障                  |
-----------------------------------------------------------------------------------------
d4                     |94                       |true                 |正常                  |
-----------------------------------------------------------------------------------------
d4                     |94                       |null                 |正常                  |
-----------------------------------------------------------------------------------------
d4                     |94                       |null                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |true                 |正常                  |
-----------------------------------------------------------------------------------------
d5                     |362                      |null                 |正常                  |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]168:select     device_id,     arrival_time,     temperature,     CASE          WHEN arrival_time < NOW() - 30D AND temperature > 85 THEN '警报：设备长时间高温'         WHEN arrival_time < NOW() - 30D THEN '警报：设备未更新'         WHEN temperature > 85 THEN '警报：高温' 		WHEN temperature is null THEN '未知'         ELSE '正常'     END AS alert from      table1 order by 1,2,3,4
STRICT{
device_id(STRING)      |arrival_time(TIMESTAMP)      |temperature(FLOAT)      |alert(STRING)      |
-----------------------------------------------------------------------------------------------
d1                     |2024-11-01T13:38:25.000+08:00|90.0                    |警报：设备长时间高温         |
-----------------------------------------------------------------------------------------------
d1                     |2024-11-26T13:37:34.000+08:00|90.0                    |警报：设备长时间高温         |
-----------------------------------------------------------------------------------------------
d2                     |2024-10-27T16:37:01.000+08:00|null                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d2                     |2024-11-27T16:37:03.000+08:00|85.0                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d2                     |2024-11-29T16:00:04.000+08:00|85.0                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d3                     |2024-10-31T16:37:08.000+08:00|null                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d3                     |null                         |null                    |未知                 |
-----------------------------------------------------------------------------------------------
d3                     |null                         |null                    |未知                 |
-----------------------------------------------------------------------------------------------
d4                     |2024-11-28T08:00:09.000+08:00|85.0                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d4                     |2024-12-01T10:00:11.000+08:00|85.0                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d4                     |null                         |null                    |未知                 |
-----------------------------------------------------------------------------------------------
d5                     |2024-11-20T18:30:15.000+08:00|90.0                    |警报：设备长时间高温         |
-----------------------------------------------------------------------------------------------
d5                     |2024-11-29T10:00:13.000+08:00|85.0                    |警报：设备未更新           |
-----------------------------------------------------------------------------------------------
d5                     |2024-11-30T11:00:12.000+08:00|88.0                    |警报：设备长时间高温         |
-----------------------------------------------------------------------------------------------
d5                     |2024-11-30T23:30:17.000+08:00|90.0                    |警报：设备长时间高温         |
-----------------------------------------------------------------------------------------------
d5                     |null                         |90.0                    |警报：高温              |
-----------------------------------------------------------------------------------------------
d5                     |null                         |null                    |未知                 |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]184:select      device_id,     temperature,     humidity,     maintenance,     CASE          WHEN temperature IS NULL OR humidity IS NULL THEN '数据不完整'         WHEN temperature > 85 AND humidity > 40 AND maintenance < '100' THEN '高风险设备'         WHEN temperature > 85 AND humidity <= 40 AND maintenance < '100' THEN '温度过高，需维护'         WHEN temperature <= 85 AND humidity > 40 AND maintenance < '100' THEN '湿度过高，需维护'         ELSE '正常设备'     END AS device_risk_category from      table1 order by 1,2,3,4,5
STRICT{
device_id(STRING)      |temperature(FLOAT)      |humidity(FLOAT)      |maintenance(STRING)      |device_risk_category(STRING)      |
-------------------------------------------------------------------------------------------------------------------------------
d1                     |90.0                    |35.1                 |190                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d1                     |90.0                    |35.1                 |190                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d2                     |85.0                    |null                 |181                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d2                     |85.0                    |null                 |181                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d2                     |null                    |35.1                 |181                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d3                     |null                    |35.2                 |155                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d3                     |null                    |null                 |155                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d3                     |null                    |null                 |155                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d4                     |85.0                    |35.2                 |94                       |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d4                     |85.0                    |null                 |94                       |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d4                     |null                    |40.9                 |94                       |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |85.0                    |null                 |362                      |数据不完整                             |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |88.0                    |45.1                 |362                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |90.0                    |34.8                 |362                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |90.0                    |35.2                 |362                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |90.0                    |35.4                 |362                      |正常设备                              |
-------------------------------------------------------------------------------------------------------------------------------
d5                     |null                    |45.1                 |362                      |数据不完整                             |
总数目：17
}

Elapsed Time: 0.0.6

-- [1]198:select      model_id,     COUNT(CASE WHEN status = true THEN 1 END) AS operational_count,     COUNT(CASE WHEN status = false THEN 1 END) AS faulty_count,     COUNT(CASE WHEN maintenance < '100' THEN 1 END) AS needing_maintenance from      table1 GROUP BY      model_id order by 1,2,3,4
STRICT{
model_id(STRING)      |operational_count(INT64)      |faulty_count(INT64)      |needing_maintenance(INT64)      |
-------------------------------------------------------------------------------------------------------------
A                     |2                             |0                        |0                               |
-------------------------------------------------------------------------------------------------------------
B                     |1                             |0                        |0                               |
-------------------------------------------------------------------------------------------------------------
C                     |0                             |3                        |0                               |
-------------------------------------------------------------------------------------------------------------
D                     |1                             |0                        |0                               |
-------------------------------------------------------------------------------------------------------------
F                     |5                             |0                        |0                               |
总数目：5
}

Elapsed Time: 0.0.7

-- [1]206:select case when true then 202 + (time + 202) end as result from table1 order by time
STRICT{
result(TIMESTAMP)      |
-----------------------
1970-01-01T08:00:01.404|
+08:00                 |
-----------------------
1970-01-01T08:00:02.404|
+08:00                 |
-----------------------
1970-01-01T08:00:03.404|
+08:00                 |
-----------------------
1970-01-01T08:00:04.404|
+08:00                 |
-----------------------
1970-01-01T08:00:06.404|
+08:00                 |
-----------------------
1970-01-01T08:00:07.404|
+08:00                 |
-----------------------
1970-01-01T08:00:08.404|
+08:00                 |
-----------------------
1970-01-01T08:00:09.404|
+08:00                 |
-----------------------
1970-01-01T08:00:10.404|
+08:00                 |
-----------------------
1970-01-01T08:00:11.404|
+08:00                 |
-----------------------
1970-01-01T08:00:12.404|
+08:00                 |
-----------------------
1970-01-01T08:00:13.404|
+08:00                 |
-----------------------
1970-01-01T08:00:14.404|
+08:00                 |
-----------------------
1970-01-01T08:00:15.404|
+08:00                 |
-----------------------
1970-01-01T08:00:16.404|
+08:00                 |
-----------------------
1970-01-01T08:00:17.404|
+08:00                 |
-----------------------
1970-01-01T08:00:18.404|
+08:00                 |
总数目：17
}

Elapsed Time: 0.0.5

-- [1]213:select model_id, 		CASE             WHEN humidity >= 40.0 THEN 'High'            WHEN humidity < 40.0 THEN 'Low'                   END AS humidity_category from 	table1 order by 1,2
STRICT{
model_id(STRING)      |humidity_category(STRING)      |
-----------------------------------------------------
A                     |Low                            |
-----------------------------------------------------
A                     |Low                            |
-----------------------------------------------------
B                     |Low                            |
-----------------------------------------------------
B                     |null                           |
-----------------------------------------------------
B                     |null                           |
-----------------------------------------------------
C                     |Low                            |
-----------------------------------------------------
C                     |null                           |
-----------------------------------------------------
C                     |null                           |
-----------------------------------------------------
D                     |High                           |
-----------------------------------------------------
D                     |Low                            |
-----------------------------------------------------
D                     |null                           |
-----------------------------------------------------
F                     |High                           |
-----------------------------------------------------
F                     |High                           |
-----------------------------------------------------
F                     |Low                            |
-----------------------------------------------------
F                     |Low                            |
-----------------------------------------------------
F                     |Low                            |
-----------------------------------------------------
F                     |null                           |
总数目：17
}

Elapsed Time: 0.0.4

-- [1]223:select device_id from table1 	WHERE CASE  			WHEN temperature > 75 THEN '高温' 			ELSE '正常' 		END = '高温' order by device_id
STRICT{
device_id(STRING)      |
-----------------------
d1                     |
-----------------------
d1                     |
-----------------------
d2                     |
-----------------------
d2                     |
-----------------------
d4                     |
-----------------------
d4                     |
-----------------------
d5                     |
-----------------------
d5                     |
-----------------------
d5                     |
-----------------------
d5                     |
-----------------------
d5                     |
总数目：11
}

Elapsed Time: 0.0.5
-- [1]234:select      model_id,     AVG(CASE              WHEN temperature IS NULL THEN 0              WHEN temperature < 0 THEN NULL              ELSE temperature          END) AS average_temperature from      table1 group by      model_id
STRICT{
SQLSTATE : 701: All result types must be the same: [INT32, unknown]
}
-- [1]247:select device_id,     CASE          WHEN temperature IS NULL THEN NULL         ELSE '正常'     END AS status from table1
STRICT{
SQLSTATE : 701: Default result type must be the same as WHEN result types: STRING vs unknown
}
-- [1]256:select  	202 + ((time - 2023-09-02 00:00:00) + (202-79.1) / 5.039) as no_bug, 	CASE 		WHEN true then 202 + ((time - 2023-09-02 00:00:00) + (202-79.1) / 5.039) 			END as bug_again, 	temperature from table1
STRICT{
SQLSTATE : 701: Cannot apply operator: TIMESTAMP + DOUBLE
}
-- [1]265:select device_id,     CASE          WHEN temperature > 75 THEN '高温'         ELSE 1     END AS temperature_status from table1
STRICT{
SQLSTATE : 701: All CASE results must be the same type or coercible to a common type. Cannot find common type between STRING and INT32, all types (without duplicates): [STRING, INT32]
}
-- [1]273:select temperature,        CASE             WHEN temperature >= 90.0 THEN 'High'            WHEN temperature < 90.0 THEN 'Low' from 	table1
STRICT{
SQLSTATE : 700: line 1:128: mismatched input 'from'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'ELSE', 'END', 'OR', 'WHEN', '||', <predicate>
}
-- [1]284:select device_id,     CASE          WHEN temperature > 75 THEN '高温'         ELSE '正常'     END AS temperature_status from  	table1 order by CASE temperature_status
STRICT{
SQLSTATE : 700: line 1:163: mismatched input '<EOF>'. Expecting: 'WHEN'
}
-- [1]297:select device_id,     CASE          WHEN temperature > 75 THEN              CASE                  WHEN humidity < 30 THEN '高温低湿'         ELSE '正常'     END AS status from table1
STRICT{
SQLSTATE : 700: line 1:156: mismatched input 'AS'. Expecting: '%', '*', '+', '-', '.', '/', 'AND', 'ELSE', 'END', 'OR', 'WHEN', '||', <predicate>
}
