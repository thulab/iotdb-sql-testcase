
-- [1]11:create database test_db
STRICT{
PASS
}

-- [1]14:use test_db
STRICT{
PASS
}

-- [1]19:create table table_1 (     region_id STRING TAG,    	device_id STRING TAG,     model_id STRING ATTRIBUTE, 	boolean BOOLEAN FIELD, 	text TEXT FIELD, 	string STRING FIELD, 	date DATE FIELD, 	timestamp TIMESTAMP FIELD, 	blob BLOB FIELD, 	int32 INT32 FIELD, 	int64 INT64 FIELD, 	float FLOAT FIELD, 	double DOUBLE FIELD )
STRICT{
PASS
}

-- [1]35:show tables
STRICT{
TableName(TEXT)      |TTL(ms)(TEXT)      |
----------------------------------------
table_1              |INF                |
总数目：1
}
Elapsed Time: 0.0.1

-- [1]38:desc table_1
STRICT{
ColumnName(TEXT)      |DataType(TEXT)      |Category(TEXT)      |
--------------------------------------------------------------
time                  |TIMESTAMP           |TIME                |
--------------------------------------------------------------
region_id             |STRING              |TAG                 |
--------------------------------------------------------------
device_id             |STRING              |TAG                 |
--------------------------------------------------------------
model_id              |STRING              |ATTRIBUTE           |
--------------------------------------------------------------
boolean               |BOOLEAN             |FIELD               |
--------------------------------------------------------------
text                  |TEXT                |FIELD               |
--------------------------------------------------------------
string                |STRING              |FIELD               |
--------------------------------------------------------------
date                  |DATE                |FIELD               |
--------------------------------------------------------------
timestamp             |TIMESTAMP           |FIELD               |
--------------------------------------------------------------
blob                  |BLOB                |FIELD               |
--------------------------------------------------------------
int32                 |INT32               |FIELD               |
--------------------------------------------------------------
int64                 |INT64               |FIELD               |
--------------------------------------------------------------
float                 |FLOAT               |FIELD               |
--------------------------------------------------------------
double                |DOUBLE              |FIELD               |
总数目：14
}
Elapsed Time: 0.0.1

-- [1]44:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 1, '001', 'd1', 'V1', false, 'text1', 'string1', '2020-01-10', 100000, X'11F8d7', 1, 1000, 1.1, 111.11 )
STRICT{
0
}
Elapsed Time: 0.2.3

-- [1]49:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 2, '002', 'd2', 'V2', true, 'text2', 'string2', '2020-02-20', 1727740800000, X'3b', 10, 453, 11.1, 102.2 )
STRICT{
0
}
Elapsed Time: 0.0.62

-- [1]54:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 3, '003', 'd3', 'V3', true, 'text2', 'string2', '2021-12-20', 1727746200000, X'6728', 1, 123, 5.2, 333.3 )
STRICT{
0
}
Elapsed Time: 0.0.12

-- [1]59:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 4, '004', 'd4', 'V4', false, 'text3', 'string3', '2022-06-11', 1727751600000, X'4b98', 2, 239, null, 666.66 )
STRICT{
0
}
Elapsed Time: 0.0.8

-- [1]64:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 5, '005', 'd1', 'V3', false, 'text4', 'string2', '2023-12-15', 1378230000000, X'34', 10, 653, -1.1, 1111.2 )
STRICT{
0
}
Elapsed Time: 0.0.6

-- [1]69:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 6, null, 'd1', 'V2', true, 'text3', 'string3', null, 1378230000000, X'34', 1, 653, 0.1, 1111.2 )
STRICT{
0
}
Elapsed Time: 0.0.5

-- [1]74:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 7, '005', 'd2', 'V3', true, 'text4', 'string4', '2023-12-15', 1378230000000, X'34', 2, null, 555.5, 1111.2 )
STRICT{
0
}
Elapsed Time: 0.0.7

-- [1]79:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 8, '002', 'd3', 'V1', true, 'text2', 'string5', null, 1378230000000, X'34', 2, 653, 13.13, null )
STRICT{
0
}
Elapsed Time: 0.0.18

-- [1]84:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 9, '003', 'd3', 'V1', true, 'text4', null, '2023-12-15', 1727758800000, X'34', 10, null, 2.1, 155.5 )
STRICT{
0
}
Elapsed Time: 0.0.10

-- [1]89:insert into table_1( time, region_id, device_id, model_id, boolean, text, string, date, timestamp, blob, int32, int64, float, double ) values( 10, '004', 'd4', 'V2', false, 'text5', 'string3', '2023-12-15', 1727768700000, null, 1, null, -1.1, 11.2 )
STRICT{
0
}
Elapsed Time: 0.0.5

-- [1]93:select * from table_1 order by time
STRICT{
time(TIMESTAMP)      |region_id(STRING)      |device_id(STRING)      |model_id(STRING)      |boolean(BOOLEAN)      |text(TEXT)      |string(STRING)      |date(DATE)      |timestamp(TIMESTAMP)      |blob(BLOB)      |int32(INT32)      |int64(INT64)      |float(FLOAT)      |double(DOUBLE)      |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|001                    |d1                     |V1                    |false                 |text1           |string1             |2020-01-10      |1970-01-01T08:01:40.000+08|0x11f8d7        |1                 |1000              |1.1               |111.11              |
01+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|002                    |d2                     |V2                    |true                  |text2           |string2             |2020-02-20      |2024-10-01T08:00:00.000+08|0x3b            |10                |453               |11.1              |102.2               |
02+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |V1                    |true                  |text2           |string2             |2021-12-20      |2024-10-01T09:30:00.000+08|0x6728          |1                 |123               |5.2               |333.3               |
03+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|004                    |d4                     |V2                    |false                 |text3           |string3             |2022-06-11      |2024-10-01T11:00:00.000+08|0x4b98          |2                 |239               |null              |666.66              |
04+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|005                    |d1                     |V3                    |false                 |text4           |string2             |2023-12-15      |2013-09-04T01:40:00.000+08|0x34            |10                |653               |-1.1              |1111.2              |
05+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|null                   |d1                     |V2                    |true                  |text3           |string3             |null            |2013-09-04T01:40:00.000+08|0x34            |1                 |653               |0.1               |1111.2              |
06+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|005                    |d2                     |V3                    |true                  |text4           |string4             |2023-12-15      |2013-09-04T01:40:00.000+08|0x34            |2                 |null              |555.5             |1111.2              |
07+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|002                    |d3                     |V1                    |true                  |text2           |string5             |null            |2013-09-04T01:40:00.000+08|0x34            |2                 |653               |13.13             |null                |
08+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |V1                    |true                  |text4           |null                |2023-12-15      |2024-10-01T13:00:00.000+08|0x34            |10                |null              |2.1               |155.5               |
09+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|004                    |d4                     |V2                    |false                 |text5           |string3             |2023-12-15      |2024-10-01T15:45:00.000+08|null            |1                 |null              |-1.1              |11.2                |
10+08:00             |                       |                       |                      |                      |                |                    |                |:00                       |                |                  |                  |                  |                    |
总数目：10
}
Elapsed Time: 0.0.6

-- [1]97:select date_bin_gapfill(2ms,time) as fill_result,date from table_1 where time > 1 and time < 10 order by time desc offset 2 limit 5
STRICT{
fill_result(TIMESTAMP)      |date(DATE)      |
--------------------------------------------
1970-01-01T08:00:00.006+08:0|2023-12-15      |
0                           |                |
--------------------------------------------
1970-01-01T08:00:00.006+08:0|null            |
0                           |                |
--------------------------------------------
1970-01-01T08:00:00.004+08:0|2023-12-15      |
0                           |                |
--------------------------------------------
1970-01-01T08:00:00.004+08:0|2022-06-11      |
0                           |                |
--------------------------------------------
1970-01-01T08:00:00.002+08:0|2021-12-20      |
0                           |                |
总数目：5
}
Elapsed Time: 0.0.7

-- [1]98:select time,date_bin_gapfill(2ms,time) as result from table_1 where time > 1 and time < 10 order by time
STRICT{
time(TIMESTAMP)      |result(TIMESTAMP)      |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.002|
02+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.002|
03+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.004|
04+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.004|
05+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.006|
06+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.006|
07+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.008|
08+08:00             |+08:00                 |
--------------------------------------------
1970-01-01T08:00:00.0|1970-01-01T08:00:00.008|
09+08:00             |+08:00                 |
总数目：8
}
Elapsed Time: 0.0.6

-- [1]101:select date_bin_gapfill(2ms,time) as result from (select * from table_1 order by time) where time > 1 and time < 10 group by 1
STRICT{
result(TIMESTAMP)      |
-----------------------
1970-01-01T08:00:00.002|
+08:00                 |
-----------------------
1970-01-01T08:00:00.004|
+08:00                 |
-----------------------
1970-01-01T08:00:00.006|
+08:00                 |
-----------------------
1970-01-01T08:00:00.008|
+08:00                 |
总数目：4
}
Elapsed Time: 0.0.9

-- [1]102:select date_bin_gapfill(2h,timestamp) as result from table_1 where timestamp between 1727740800000 and 1727769600000 group by 1
STRICT{
result(TIMESTAMP)      |
-----------------------
2024-10-01T08:00:00.000|
+08:00                 |
-----------------------
2024-10-01T10:00:00.000|
+08:00                 |
-----------------------
2024-10-01T12:00:00.000|
+08:00                 |
-----------------------
2024-10-01T14:00:00.000|
+08:00                 |
总数目：4
}
Elapsed Time: 0.0.7

-- [1]106:select date_bin_gapfill(3ms, time) AS ms_time, avg(int32) AS avg_int32   from table_1   where (time >= 1 AND time <10 )          AND device_id = 'd1'   GROUP BY 1
STRICT{
ms_time(TIMESTAMP)      |avg_int32(DOUBLE)      |
-----------------------------------------------
1970-01-01T08:00:00.000+|1.0                    |
08:00                   |                       |
-----------------------------------------------
1970-01-01T08:00:00.003+|10.0                   |
08:00                   |                       |
-----------------------------------------------
1970-01-01T08:00:00.006+|1.0                    |
08:00                   |                       |
总数目：3
}
Elapsed Time: 0.0.7

-- [1]113:select time, region_id, device_id, date_bin_gapfill(2h, timestamp) AS hour_time, (max(double) + min(float)) AS total_result   from table_1   where (timestamp >= 1727740800000 AND timestamp < 1727769600000)          AND device_id = 'd3' and region_id='003'   GROUP BY 1,2,3,4   HAVING avg(int32) IS NOT NULL
STRICT{
time(TIMESTAMP)      |region_id(STRING)      |device_id(STRING)      |hour_time(TIMESTAMP)      |total_result(DOUBLE)      |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T08:00:00.000+08|338.49999980926515        |
03+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T10:00:00.000+08|null                      |
03+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T12:00:00.000+08|null                      |
03+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T14:00:00.000+08|null                      |
03+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T08:00:00.000+08|null                      |
09+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T10:00:00.000+08|null                      |
09+08:00             |                       |                       |:00                       |                          |
-----------------------------------------------------------------------------------------------------------------------
1970-01-01T08:00:00.0|003                    |d3                     |2024-10-01T12:00:00.000+08|157.59999990463257        |
09+08:00             |                       |                       |:00                       |                          |
总数目：7
}
Elapsed Time: 0.0.10

-- [1]117:select date_bin_gapfill(3h, timestamp) AS hour_time, region_id, avg(int64-int32+2) AS avg_result   from table_1   where timestamp >= 1727740800000 AND timestamp < 1727769600000 and boolean=false   group by 1, region_id
STRICT{
hour_time(TIMESTAMP)      |region_id(STRING)      |avg_result(DOUBLE)      |
-------------------------------------------------------------------------
2024-10-01T08:00:00.000+08|004                    |null                    |
:00                       |                       |                        |
-------------------------------------------------------------------------
2024-10-01T11:00:00.000+08|004                    |239.0                   |
:00                       |                       |                        |
-------------------------------------------------------------------------
2024-10-01T14:00:00.000+08|004                    |null                    |
:00                       |                       |                        |
总数目：3
}
Elapsed Time: 0.0.7

-- [1]123:select date_bin_gapfill(2ms,time), date_bin_gapfill(2h,timestamp), count(text) from table_1 	where time > 2 and time <= 10  		group by 1,2
STRICT{
SQLSTATE : 701: multiple date_bin_gapfill calls not allowed
}

-- [1]129:select date_bin_gapfill(2ms,time) from table_1 where device_id='d3' group by 1
STRICT{
SQLSTATE : 701: could not infer startTime or endTime from WHERE clause
}
